<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¸”ë¡œê·¸ ìë™ ì‘ì„±ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #2196F3, #21CBF3);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 1.25em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .login-area {
            position: absolute;
            top: 20px;
            right: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .settings-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            margin-right: 10px;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: rotate(90deg);
        }

        .login-btn, .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .login-btn:hover, .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .user-info {
            color: white;
            font-size: 14px;
            opacity: 0.9;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            width: 100%;
            margin-bottom: 20px;
        }

        .header-nav {
            position: absolute;
            top: 20px;
            left: 30px;
        }

        .keyword-discovery-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .keyword-discovery-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .keyword-discovery-btn:active {
            transform: translateY(0);
        }

        /* í‚¤ì›Œë“œë°œêµ´ í™”ë©´ ìŠ¤íƒ€ì¼ */
        .keyword-discovery-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 1000;
            overflow-y: auto;
        }

        .keyword-discovery-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .keyword-discovery-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            position: relative;
        }

        .back-btn {
            position: absolute;
            left: 0;
            top: 0;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .keyword-discovery-header h1 {
            font-size: 2.5em;
            margin: 20px 0 10px 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .keyword-discovery-header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .keyword-discovery-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }

        .new-keyword-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }
        
        .new-keyword-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .new-keyword-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            background: linear-gradient(135deg, #ff5252 0%, #ff3742 100%);
        }
        
        .new-keyword-btn:active {
            transform: translateY(-1px);
        }
        
        .new-keyword-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .search-section {
            margin-bottom: 40px;
        }

        .search-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .search-form {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .keyword-input {
            flex: 1;
            min-width: 300px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .keyword-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .discovery-results {
            margin: 40px 0;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }

        .result-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }

        .result-section h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .analysis-content, .keywords-list {
            min-height: 100px;
        }

        .discovery-tips {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8f0 100%);
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
        }

        .discovery-tips h4 {
            color: #2e7d32;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .discovery-tips ul {
            list-style: none;
            padding: 0;
        }

        .discovery-tips li {
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
            line-height: 1.5;
        }

        .discovery-tips li:before {
            content: "ğŸ’¡";
            position: absolute;
            left: 0;
        }

        .discovery-logic-explanation {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .discovery-logic-explanation h5 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 8px;
        }

        .logic-steps {
            margin-bottom: 20px;
        }

        .logic-item {
            background: white;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            line-height: 1.6;
        }

        .discovery-tips-mini {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #b3e5fc;
        }

        .discovery-tips-mini h5 {
            color: #0277bd;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .discovery-tips-mini ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .discovery-tips-mini li {
            margin-bottom: 8px;
            padding-left: 15px;
            position: relative;
            font-size: 14px;
            line-height: 1.4;
        }

        .discovery-tips-mini li:before {
            content: "âœ¨";
            position: absolute;
            left: 0;
            font-size: 12px;
        }

        @media (max-width: 768px) {
            .search-form {
                flex-direction: column;
            }
            
            .keyword-input {
                min-width: 100%;
            }
            
            .back-btn {
                position: relative;
                margin-bottom: 20px;
            }
            
            .keyword-discovery-header h1 {
                font-size: 2em;
            }
        }

        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1001;
        }

        .login-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 40px;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .login-modal h3 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.5em;
        }

        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1003;
            backdrop-filter: blur(5px);
        }

        .settings-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .settings-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .settings-header h3 {
            margin: 0;
            font-size: 1.4em;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .close-modal:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .settings-body {
            padding: 30px;
        }

        .settings-footer {
            padding: 20px 30px;
            border-top: 1px solid #eee;
            text-align: center;
        }

        .save-settings-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .save-settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .save-settings-btn:active {
            transform: translateY(0);
        }

        .keyword-choice-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1004;
            backdrop-filter: blur(5px);
        }

        .keyword-choice-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .keyword-choice-header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .keyword-choice-header h3 {
            margin: 0;
            font-size: 1.3em;
        }

        .keyword-choice-body {
            padding: 30px;
        }

        .selected-keyword-info {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%);
            border-radius: 10px;
            border: 1px solid #ffcccb;
        }

        .keyword-label {
            font-size: 14px;
            color: #666;
            display: block;
            margin-bottom: 8px;
        }

        .selected-keyword {
            font-size: 18px;
            font-weight: 700;
            color: #e53e3e;
            background: white;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            box-shadow: 0 2px 8px rgba(229, 62, 62, 0.2);
        }

        .choice-description {
            text-align: center;
            margin-bottom: 25px;
            color: #555;
            font-size: 16px;
        }

        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .choice-btn:hover {
            border-color: #667eea;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .choice-btn.main-search-btn:hover {
            border-color: #2196F3;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        }

        .choice-btn.keyword-discovery-btn-choice:hover {
            border-color: #9C27B0;
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
        }

        .btn-icon {
            font-size: 24px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .btn-content {
            flex: 1;
        }

        .btn-title {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .btn-description {
            font-size: 13px;
            color: #718096;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .keyword-choice-modal-content {
                width: 95%;
                margin: 20px;
            }
            
            .choice-buttons {
                gap: 12px;
            }
            
            .choice-btn {
                padding: 15px;
            }
            
            .btn-title {
                font-size: 15px;
            }
            
            .btn-description {
                font-size: 12px;
            }
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .login-form input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .login-form input:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .login-form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .login-submit-btn {
            flex: 1;
            background: #2196F3;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-submit-btn:hover {
            background: #1976D2;
        }

        .login-cancel-btn {
            flex: 1;
            background: #6c757d;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-cancel-btn:hover {
            background: #5a6268;
        }

        .form-container {
            padding: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
            font-size: 1.1em;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: all 0.3s ease;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .form-group textarea {
            min-height: 100px;
            line-height: 1.5;
        }

        .api-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .api-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .generate-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .generate-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2196F3;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result {
            display: none;
            margin-top: 30px;
            padding: 25px;
            background: #e8f5e8;
            border-radius: 10px;
            border-left: 5px solid #4CAF50;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .result h3 {
            color: #2e7d32;
            margin: 0;
        }

        .copy-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: #1976D2;
            transform: translateY(-1px);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        .copy-btn.copied {
            background: #4CAF50;
        }
        
        .ai-generate-btn {
            background: #9C27B0;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-top: 15px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .ai-generate-btn:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(156, 39, 176, 0.3);
        }
        
        .ai-generate-btn:active {
            transform: translateY(0);
        }
        
        .ai-generate-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .gemini-generate-btn {
            background: #4285F4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-top: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .gemini-generate-btn:hover {
            background: #3367D6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
        }
        
        .gemini-generate-btn:active {
            transform: translateY(0);
        }
        
        .gemini-generate-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .ai-generate-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        .second-generation-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .text-replacement-section {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .text-replacement-section h4 {
            margin: 0 0 15px 0;
            color: #495057;
            font-size: 16px;
        }
        
        .replacement-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 768px) {
            .replacement-fields {
                grid-template-columns: 1fr;
            }
        }
        
        .ai-result {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .ai-result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .ai-result h3 {
            color: white;
            margin: 0;
            font-size: 1.3em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .ai-result-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 20px;
            white-space: pre-wrap;
            line-height: 1.8;
            font-size: 15px;
            color: #333;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
            min-height: 200px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .compare-btn {
            background: #FF5722;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s ease;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .compare-btn:hover {
            background: #E64A19;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 87, 34, 0.3);
        }
        
        .compare-btn:active {
            transform: translateY(0);
        }
        
        .comparison-result {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .comparison-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .comparison-header h3 {
            color: #333;
            margin: 0;
            font-size: 1.3em;
        }
        
        .comparison-content {
            background: white;
            border-radius: 8px;
            padding: 20px;
            line-height: 1.8;
            font-size: 15px;
            max-height: 700px;
            overflow-y: auto;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .comparison-paragraph {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #ddd;
        }
        
        .original-text {
            background: #f8f9fa;
            border-left-color: #6c757d;
            color: #212529;
        }
        
        .ai-text {
            background: #fff5f5;
            border-left-color: #dc3545;
            color: #dc3545;
        }
        
        .paragraph-label {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 8px;
            opacity: 0.8;
        }
        
        .blog-selection-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            margin-bottom: 15px;
            justify-content: center;
        }
        
        .blog-select-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 140px;
            max-width: 180px;
        }
        
        .blog-select-btn:hover {
            background: #45a049;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }
        
        .blog-select-btn:active {
            transform: translateY(0);
        }
        
        .blog-select-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .blog-select-btn.all-blogs {
            background: #FF9800;
            font-weight: 600;
        }
        
        .blog-select-btn.all-blogs:hover {
            background: #F57C00;
            box-shadow: 0 2px 8px rgba(255, 152, 0, 0.3);
        }
        
        @media (max-width: 768px) {
            .blog-selection-buttons {
                flex-direction: column;
            }
            
            .blog-select-btn {
                max-width: none;
            }
        }


        .fetch-blogs-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            margin: 10px 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .fetch-blogs-btn:hover {
            background: #1976D2;
            transform: translateY(-1px);
        }

        .fetch-blogs-btn:active {
            transform: translateY(0);
        }

        .fetch-blogs-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .url-input-section {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8f0 100%);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid #e0f2e0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .url-input-section h3 {
            color: #2e7d32;
            margin: 0 0 15px 0;
            font-size: 1.1em;
            font-weight: 600;
            text-align: center;
        }

        .url-fetch-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin-top: 12px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .url-fetch-btn:hover {
            background: #45a049;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .url-fetch-btn:active {
            transform: translateY(0);
        }

        .url-fetch-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .blog-posts-results {
            display: none;
            margin-top: 25px;
            padding: 25px;
            background: #f0f8ff;
            border-radius: 10px;
            border-left: 5px solid #2196F3;
        }

        .blog-posts-results h3 {
            color: #1976D2;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .blog-post-item {
            background: white;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e3f2fd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .blog-post-item:last-child {
            margin-bottom: 0;
        }

        .blog-post-header {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
        }

        .blog-post-header input[type="radio"] {
            margin-top: 4px;
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .blog-post-title {
            font-weight: bold;
            color: #1976D2;
            font-size: 1.1em;
            line-height: 1.4;
            cursor: pointer;
            flex: 1;
        }

        .blog-post-title:hover {
            color: #1565C0;
            text-decoration: underline;
        }

        .blog-post-content {
            color: #555;
            line-height: 1.6;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }

        .blog-post-link {
            font-size: 0.9em;
            color: #2196F3;
            text-decoration: none;
            display: inline-block;
            margin-top: 8px;
        }

        .blog-post-link:hover {
            text-decoration: underline;
        }

        .first-post-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .first-post-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .first-post-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }


        .prompt-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .prompt-btn {
            background: #6366F1;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .prompt-btn:hover {
            background: #5B57EB;
            transform: translateY(-1px);
        }

        .prompt-btn.secondary {
            background: #10B981;
        }

        .prompt-btn.secondary:hover {
            background: #059669;
        }

        .prompt-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .prompt-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .prompt-modal h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .prompt-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .prompt-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .prompt-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .prompt-item-title {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }

        .prompt-item-content {
            color: #6c757d;
            font-size: 14px;
            line-height: 1.4;
        }

        .prompt-form {
            display: none;
        }

        .prompt-form.show {
            display: block;
        }

        .prompt-form input,
        .prompt-form textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 15px;
            font-family: inherit;
        }

        .prompt-form input:focus,
        .prompt-form textarea:focus {
            outline: none;
            border-color: #6366F1;
        }

        .prompt-form-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close-modal:hover {
            color: #333;
        }

        .result-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            white-space: pre-wrap;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }

        .error {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #ffebee;
            color: #c62828;
            border-radius: 8px;
            border-left: 5px solid #f44336;
        }

        .info-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid #2196F3;
        }

        .info-box h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .info-box p {
            color: #424242;
            line-height: 1.5;
        }

        .search-results {
            display: none;
            margin-top: 25px;
            padding: 25px;
            background: #fff3e0;
            border-radius: 10px;
            border-left: 5px solid #ff9800;
        }

        .search-results h3 {
            color: #e65100;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .search-item {
            background: white;
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ffcc02;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .search-item:last-child {
            margin-bottom: 0;
        }

        .search-item-title {
            font-weight: bold;
            color: #d84315;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .search-item-content {
            color: #555;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .search-item-link {
            font-size: 0.9em;
            color: #1976d2;
            text-decoration: none;
        }

        .search-item-link:hover {
            text-decoration: underline;
        }


        .keyword-input-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .keyword-input-section input {
            width: 70%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            margin-right: 10px;
        }

        .keyword-analyze-btn {
            background: #9C27B0;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }

        .keyword-analyze-btn:hover {
            background: #7B1FA2;
        }

        .keyword-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .keyword-result-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .keyword-result-card h4 {
            color: #9C27B0;
            margin-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .keyword-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .keyword-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
            gap: 15px;
        }

        .keyword-item:last-child {
            border-bottom: none;
        }

        .keyword-item > div:first-child {
            flex: 1;
            min-width: 0;
        }

        .keyword-name {
            font-weight: bold;
            color: #333;
            word-wrap: break-word;
            word-break: break-all;
            line-height: 1.4;
            max-width: 200px;
        }

        .keyword-stats {
            display: flex;
            gap: 8px;
            font-size: 11px;
            flex-direction: column;
            align-items: flex-end;
            min-width: 120px;
        }

        @media (min-width: 768px) {
            .keyword-stats {
                flex-direction: row;
                align-items: center;
                font-size: 12px;
                gap: 10px;
                min-width: 200px;
            }
        }

        .keyword-volume {
            background: #4CAF50;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .keyword-competition {
            background: #FF9800;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .keyword-competition.low {
            background: #4CAF50;
        }

        .keyword-competition.medium {
            background: #FF9800;
        }

        .keyword-competition.high {
            background: #f44336;
        }

        .keyword-select-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .keyword-select-btn:hover {
            background: #1976D2;
        }

        .keyword-usage-guide {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #f0f0f0;
        }

        .keyword-usage-guide h3 {
            color: #9C27B0;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.3em;
        }

        .usage-steps {
            display: grid;
            gap: 20px;
            margin-bottom: 30px;
        }

        .usage-step {
            display: flex;
            align-items: flex-start;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #9C27B0;
        }

        .step-number {
            background: #9C27B0;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .step-content h4 {
            color: #333;
            margin: 0 0 8px 0;
            font-size: 1.1em;
        }

        .step-content p {
            color: #666;
            margin: 0;
            line-height: 1.5;
        }

        .usage-tips {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #2196F3;
        }

        .usage-tips h4 {
            color: #1976D2;
            margin: 0 0 15px 0;
            font-size: 1.1em;
        }

        .usage-tips ul {
            margin: 0;
            padding-left: 20px;
        }

        .usage-tips li {
            color: #424242;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .usage-tips li:last-child {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-top">
                <div class="header-nav">
                    <button class="keyword-discovery-btn" onclick="showKeywordDiscovery()">ğŸ” í‚¤ì›Œë“œë°œêµ´</button>
                </div>
                <div class="login-area" id="loginArea">
                    <button class="login-btn" id="loginBtn" onclick="showLoginModal()">ğŸ‘¤ ë¡œê·¸ì¸</button>
                    <button class="settings-btn" id="settingsBtn" onclick="showSettingsModal()" title="ì„¤ì •">âš™ï¸</button>
                </div>
            </div>
            <h1>ë¸”ë¡œê·¸ ìë™ ì‘ì„±ê¸°</h1>
        </div>

        <div class="form-container">
            <div class="info-box">
                <h4>ğŸ’¡ ì‚¬ìš© ë°©ë²•</h4>
                <p><strong>ë„¤ì´ë²„ ê²€ìƒ‰ APIì™€ Claude AIë¥¼ í™œìš©í•œ SEO ìµœì í™” ë¸”ë¡œê·¸ ê¸€ ìƒì„±</strong></p>
                <p>í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ê³  ë„¤ì´ë²„ ê²€ìƒ‰ APIì™€ Claude API í‚¤ë¥¼ ì…ë ¥í•˜ë©´, í•´ë‹¹ í‚¤ì›Œë“œë¡œ ë„¤ì´ë²„ ë¸”ë¡œê·¸ë¥¼ ê²€ìƒ‰í•˜ì—¬ ì°¸ê³  ìë£Œë¥¼ ìˆ˜ì§‘í•˜ê³ , SEO ìµœì í™”ëœ 2000ì ë¶„ëŸ‰ì˜ ë¸”ë¡œê·¸ ê¸€ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.</p>
            </div>

            <form id="blogForm">
                <div class="form-group">
                    <label for="keyword">ê²€ìƒ‰ í‚¤ì›Œë“œ</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="keyword" name="keyword" placeholder="ë¸”ë¡œê·¸ ê¸€ ì£¼ì œ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”" required style="flex: 1;">
                    </div>
                </div>




                <button type="button" class="fetch-blogs-btn" onclick="fetchBlogPosts()">
                    ğŸ“„ ë¸”ë¡œê·¸ê¸€ ê°€ì ¸ì˜¤ê¸°
                </button>


            </form>

            <div class="blog-posts-results" id="blogPostsResults">
                <h3>ğŸ“„ ê°€ì ¸ì˜¨ ë¸”ë¡œê·¸ ê¸€ ëª©ë¡</h3>
                <div id="blogPostsList"></div>
                <div class="blog-selection-buttons" id="blogSelectionButtons" style="display: none;">
                    <button type="button" class="blog-select-btn" onclick="scrapeSelectedBlog()">
                        ğŸ“„ ì„ íƒëœë‚´ìš© ê°€ì ¸ì˜¤ê¸°
                    </button>
                </div>
            </div>

            <div class="search-results" id="searchResults">
                <h3>ğŸ“‹ ìˆ˜ì§‘ëœ ë„¤ì´ë²„ ë¸”ë¡œê·¸ ê²€ìƒ‰ ê²°ê³¼</h3>
                <div id="searchResultsList"></div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>ë„¤ì´ë²„ì—ì„œ ê²€ìƒ‰ ì¤‘ì´ê³  Claude AIê°€ ë¸”ë¡œê·¸ ê¸€ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...<br>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
            </div>

            <div class="error" id="error"></div>

            <!-- URL ì…ë ¥ ì„¹ì…˜ -->
            <div class="url-input-section">
                <h3>ğŸ”— ì§ì ‘ URL ì…ë ¥</h3>
                <div class="form-group">
                    <input type="url" id="directUrlInput" placeholder="ë„¤ì´ë²„ ë¸”ë¡œê·¸ URLì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: https://blog.naver.com/blogid/123456)" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                </div>
                <button type="button" class="url-fetch-btn" onclick="fetchFromDirectUrl()">
                    ğŸ”— URLì—ì„œ ê¸€ ê°€ì ¸ì˜¤ê¸°
                </button>
            </div>

            <div class="result" id="result">
                <div class="result-header">
                    <h3>ğŸ“„ ìŠ¤í¬ë©ëœê¸€</h3>
                    <button class="copy-btn" id="copyBtn" onclick="copyToClipboard()">
                        ğŸ“‹ ë³µì‚¬í•˜ê¸°
                    </button>
                </div>
                <div class="result-content" id="resultContent"></div>
            </div>
            
            <!-- AI í”„ë¡¬í”„íŠ¸ ì„¹ì…˜ -->
            <div class="ai-prompt-section" id="aiPromptSection" style="display: none;">
                <h3>ğŸ¤– AI í”„ë¡¬í”„íŠ¸ ì„¤ì •</h3>
                <div class="form-group">
                    <label for="aiPrompt">AI í”„ë¡¬í”„íŠ¸</label>
                    <textarea id="aiPrompt" name="aiPrompt" rows="16" placeholder="AIê°€ ì–´ë–¤ ìŠ¤íƒ€ì¼ë¡œ ê¸€ì„ ì‘ì„±í•˜ê¸¸ ì›í•˜ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”. ì˜ˆ: 'ì´ˆë³´ìë„ ì´í•´í•˜ê¸° ì‰½ê²Œ ì¹œê·¼í•œ ë§íˆ¬ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”', 'ì „ë¬¸ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë‚´ìš©ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”' ë“±" required></textarea>
                    <div class="prompt-controls">
                        <button type="button" class="prompt-btn" onclick="showPromptModal()">ğŸ“ AI í”„ë¡¬í”„íŠ¸ ì¡°íšŒ</button>
                    </div>
                    
                    <!-- í…ìŠ¤íŠ¸ ëŒ€ì²´ í•„ë“œë“¤ -->
                    <div class="text-replacement-section">
                        <h4>ğŸ”„ í…ìŠ¤íŠ¸ ëŒ€ì²´ (ì„ íƒì‚¬í•­)</h4>
                        <div class="replacement-fields">
                            <div class="form-group">
                                <label for="replaceText">ëŒ€ì²´í• í…ìŠ¤íŠ¸</label>
                                <input type="text" id="replaceText" name="replaceText" placeholder="ìŠ¤í¬ë©ëœ ê¸€ì—ì„œ ë°”ê¿€ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                            </div>
                            <div class="form-group">
                                <label for="newText">ìƒˆë¡œìš´í…ìŠ¤íŠ¸</label>
                                <input type="text" id="newText" name="newText" placeholder="ìƒˆë¡œ ë°”ê¿€ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ai-generate-buttons">
                    <button type="button" class="ai-generate-btn" id="aiGenerateBtn" onclick="generateAIContent()" style="display: none;">
                        ğŸ¤– Claudeë¡œ ê¸€ìƒì„±í•˜ê¸°
                    </button>
                    <button type="button" class="gemini-generate-btn" id="geminiGenerateBtn" onclick="generateGeminiContent()" style="display: none;">
                        ğŸ’ Geminië¡œ ê¸€ìƒì„±í•˜ê¸°
                    </button>
                </div>
            </div>
            
            <!-- AI ìƒì„±ëœ ê¸€ ì„¹ì…˜ -->
            <div class="ai-result" id="aiResult" style="display: none;">
                <div class="ai-result-header">
                    <h3>âœ¨ ì²«ë²ˆì§¸ ìƒì„±ëœê¸€</h3>
                    <button class="copy-btn" id="aiCopyBtn" onclick="copyAIToClipboard()">
                        ğŸ“‹ ë³µì‚¬í•˜ê¸°
                    </button>
                </div>
                <div class="ai-result-content" id="aiResultContent"></div>
                <button type="button" class="compare-btn" id="compareBtn" onclick="compareTexts()" style="display: none;">
                    ğŸ“Š ì›ë¬¸ê³¼ ë¹„êµí•˜ê¸°
                </button>
                <div class="second-generation-buttons" id="secondGenerationButtons" style="display: none;">
                    <button type="button" class="ai-generate-btn" id="generateFromFirstClaudeBtn" onclick="generateFromFirstClaude()">
                        ğŸ¤– ì²«ë²ˆì§¸ ìƒì„±ëœê¸€ë¡œ Claude ê¸€ì‘ì„±í•˜ê¸°
                    </button>
                    <button type="button" class="gemini-generate-btn" id="generateFromFirstGeminiBtn" onclick="generateFromFirstGemini()">
                        ğŸ’ ì²«ë²ˆì§¸ ìƒì„±ëœê¸€ë¡œ Gemini ê¸€ì‘ì„±í•˜ê¸°
                    </button>
                </div>
            </div>
            
            <!-- ë‘ë²ˆì§¸ AI ìƒì„±ëœ ê¸€ ì„¹ì…˜ -->
            <div class="ai-result" id="aiResult2" style="display: none;">
                <div class="ai-result-header">
                    <h3>âœ¨ ë‘ë²ˆì§¸ ìƒì„±ëœê¸€</h3>
                    <button class="copy-btn" id="aiCopyBtn2" onclick="copyAI2ToClipboard()">
                        ğŸ“‹ ë³µì‚¬í•˜ê¸°
                    </button>
                </div>
                <div class="ai-result-content" id="aiResultContent2"></div>
                <button type="button" class="compare-btn" id="compareBtn2" onclick="compareTexts2()" style="display: none;">
                    ğŸ“Š ì›ë¬¸ê³¼ ë¹„êµí•˜ê¸°
                </button>
            </div>
            
            <!-- ì›ë¬¸ê³¼ ë¹„êµí•˜ê¸° ì„¹ì…˜ -->
            <div class="comparison-result" id="comparisonResult" style="display: none;">
                <div class="comparison-header">
                    <h3>ğŸ“Š ì›ë¬¸ê³¼ ë¹„êµí•˜ê¸°</h3>
                </div>
                <div class="comparison-content" id="comparisonContent"></div>
            </div>
        </div>
    </div>

    <!-- AI í”„ë¡¬í”„íŠ¸ ê´€ë¦¬ ëª¨ë‹¬ -->
    <div class="prompt-modal" id="promptModal">
        <div class="prompt-modal-content">
            <button class="close-modal" onclick="closePromptModal()">Ã—</button>
            
            <!-- í”„ë¡¬í”„íŠ¸ ëª©ë¡ ë³´ê¸° -->
            <div id="promptListView">
                <h3>ğŸ’¡ ì €ì¥ëœ AI í”„ë¡¬í”„íŠ¸ ëª©ë¡</h3>
                <div class="prompt-list" id="promptList">
                    <!-- í”„ë¡¬í”„íŠ¸ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
                <div class="prompt-form-buttons">
                    <button type="button" class="prompt-btn secondary" onclick="showNewPromptForm()">â• ìƒˆ í”„ë¡¬í”„íŠ¸ ì¶”ê°€</button>
                    <button type="button" class="prompt-btn" onclick="closePromptModal()">ë‹«ê¸°</button>
                </div>
            </div>

            <!-- í”„ë¡¬í”„íŠ¸ ë“±ë¡/ìˆ˜ì • í¼ -->
            <div class="prompt-form" id="promptForm">
                <h3 id="promptFormTitle">ğŸ†• ìƒˆ AI í”„ë¡¬í”„íŠ¸ ë“±ë¡</h3>
                <form id="promptFormElement">
                    <input type="hidden" id="promptId" name="promptId">
                    <input type="text" id="promptTitle" name="title" placeholder="í”„ë¡¬í”„íŠ¸ ì œëª© (ì˜ˆ: ì¹œê·¼í•œ ë¸”ë¡œê·¸ ìŠ¤íƒ€ì¼)" required>
                    <textarea id="promptContent" name="content" rows="4" placeholder="AI í”„ë¡¬í”„íŠ¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" required></textarea>
                    <div class="prompt-form-buttons">
                        <button type="button" class="prompt-btn" onclick="cancelPromptForm()">ì·¨ì†Œ</button>
                        <button type="submit" class="prompt-btn secondary" id="promptSubmitBtn">ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- í‚¤ì›Œë“œë°œêµ´ í™”ë©´ -->
    <div class="keyword-discovery-page" id="keywordDiscoveryPage" style="display: none;">
        <div class="keyword-discovery-container">
            <div class="keyword-discovery-header">
                <button class="back-btn" onclick="hideKeywordDiscovery()">â† ë˜ëŒì•„ê°€ê¸°</button>
                <h1>ğŸ” í‚¤ì›Œë“œë°œêµ´</h1>
                <p>íš¨ê³¼ì ì¸ í‚¤ì›Œë“œë¥¼ ë°œêµ´í•˜ì—¬ ë¸”ë¡œê·¸ ì½˜í…ì¸ ë¥¼ ìµœì í™”í•˜ì„¸ìš”</p>
            </div>

            <div class="keyword-discovery-content">
                <div class="new-keyword-section">
                    <button class="new-keyword-btn" onclick="discoverNewKeywords()">ğŸ†• ì‹ ê·œí‚¤ì›Œë“œ ê²€ìƒ‰</button>
                </div>
                
                <div class="search-section">
                    <h3>ğŸ¯ í‚¤ì›Œë“œ ê²€ìƒ‰</h3>
                    <div class="search-form">
                        <input type="text" id="keywordDiscoveryInput" placeholder="ê¸°ë³¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì—ì–´ì»¨ì²­ì†Œ, ì¹´í˜ì°½ì—…)" class="keyword-input">
                        <button class="search-btn" onclick="startKeywordDiscovery()">ğŸ” í‚¤ì›Œë“œ ë°œêµ´ ì‹œì‘</button>
                    </div>
                </div>

                <div class="discovery-results" id="discoveryResults" style="display: none;">
                    <div class="results-grid">
                        <div class="result-section">
                            <h4>ğŸ“Š ê¸°ë³¸ í‚¤ì›Œë“œ ë¶„ì„</h4>
                            <div id="basicAnalysis" class="analysis-content">
                                <div class="discovery-logic-explanation">
                                    <h5>ğŸš€ ì‹ ê·œ í‚¤ì›Œë“œ ë°œêµ´ ë¡œì§</h5>
                                    <div class="logic-steps">
                                        <div class="logic-item">
                                            <strong>1ï¸âƒ£ ì—°ê´€ í‚¤ì›Œë“œ ë¶„ì„:</strong> ì…ë ¥ í‚¤ì›Œë“œì˜ ë™ì˜ì–´, ìœ ì˜ì–´, ê´€ë ¨ ì—…ì¢… ìš©ì–´ë¥¼ ìë™ ì¶”ì¶œí•˜ì—¬ í‚¤ì›Œë“œ í’€ì„ í™•ì¥í•©ë‹ˆë‹¤.
                                        </div>
                                        <div class="logic-item">
                                            <strong>2ï¸âƒ£ ë¡±í…Œì¼ í‚¤ì›Œë“œ ìƒì„±:</strong> "ì£¼ìš”í‚¤ì›Œë“œ + ìˆ˜ì‹ì–´ + ëª©ì ì–´" íŒ¨í„´ìœ¼ë¡œ ê²€ìƒ‰ ì˜ë„ê°€ ëª…í™•í•œ 3-5ë‹¨ì–´ ì¡°í•©ì„ ìƒì„±í•©ë‹ˆë‹¤.
                                        </div>
                                        <div class="logic-item">
                                            <strong>3ï¸âƒ£ ì§€ì—­ ê¸°ë°˜ í‚¤ì›Œë“œ:</strong> "ì§€ì—­ëª… + ì„œë¹„ìŠ¤/ìƒí’ˆëª…" íŒ¨í„´ìœ¼ë¡œ ë¡œì»¬ SEO ìµœì í™” í‚¤ì›Œë“œë¥¼ ë°œêµ´í•©ë‹ˆë‹¤.
                                        </div>
                                        <div class="logic-item">
                                            <strong>4ï¸âƒ£ ì˜ë„ ê¸°ë°˜ ë¶„ë¥˜:</strong> ì •ë³´ì„±("ë°©ë²•", "íŒ"), êµ¬ë§¤ì„±("ê°€ê²©", "í• ì¸"), ë¹„êµì„±("vs", "ì°¨ì´"), ë¬¸ì œí•´ê²°("í•´ê²°", "ë¬¸ì œ") í‚¤ì›Œë“œë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤.
                                        </div>
                                        <div class="logic-item">
                                            <strong>5ï¸âƒ£ íŠ¸ë Œë“œ í‚¤ì›Œë“œ:</strong> í˜„ì¬ ì‹œê¸°ì˜ ì´ë²¤íŠ¸, ì‹œì¦Œ, ì‚¬íšŒì  ì´ìŠˆì™€ ì—°ê²°ëœ í‚¤ì›Œë“œë¥¼ ìë™ ì¶”ì²œí•©ë‹ˆë‹¤.
                                        </div>
                                        <div class="logic-item">
                                            <strong>6ï¸âƒ£ ê²½ìŸ ë¶„ì„:</strong> ë„¤ì´ë²„ ê²€ìƒ‰ ìƒìœ„ í˜ì´ì§€ ë¶„ì„ì„ í†µí•´ ê²½ìŸì´ ë‚®ì€ ëŒ€ì•ˆ í‚¤ì›Œë“œë¥¼ ë°œêµ´í•©ë‹ˆë‹¤.
                                        </div>
                                    </div>
                                    
                                    <div class="discovery-tips-mini">
                                        <h5>ğŸ’¡ í‚¤ì›Œë“œ í™œìš© í•µì‹¬ íŒ</h5>
                                        <ul>
                                            <li><strong>íƒ€ê²ŸíŒ…:</strong> ë¸Œë¡œë“œë³´ë‹¤ ë¡±í…Œì¼ í‚¤ì›Œë“œê°€ ì „í™˜ìœ¨ì´ ë†’ìŒ</li>
                                            <li><strong>SEO:</strong> ìì—°ìŠ¤ëŸ¬ìš´ í‚¤ì›Œë“œ ë°°ì¹˜, ê³¼ë„í•œ ìŠ¤í„°í•‘ ê¸ˆì§€</li>
                                            <li><strong>ëª¨ë‹ˆí„°ë§:</strong> ì •ê¸°ì  ì„±ê³¼ ë¶„ì„ ë° íŠ¸ë Œë“œ ì—…ë°ì´íŠ¸</li>
                                            <li><strong>ê³„ì ˆì„±:</strong> ì‹œê¸°ë³„ ì´ë²¤íŠ¸ì— ë§ì¶˜ ì½˜í…ì¸  ì¤€ë¹„</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="result-section">
                            <h4>ğŸ”— ì—°ê´€ í‚¤ì›Œë“œ</h4>
                            <div id="relatedKeywords" class="keywords-list"></div>
                        </div>
                        
                        <div class="result-section">
                            <h4>ğŸ“ˆ ë¡±í…Œì¼ í‚¤ì›Œë“œ</h4>
                            <div id="longTailKeywords" class="keywords-list"></div>
                        </div>
                        
                        <div class="result-section">
                            <h4>ğŸš€ ê¸‰ìƒìŠ¹ í‚¤ì›Œë“œ</h4>
                            <div id="trendingKeywords" class="keywords-list"></div>
                        </div>
                    </div>
                </div>

                <div class="discovery-tips">
                    <h4>ğŸ’¡ í‚¤ì›Œë“œë°œêµ´ íŒ</h4>
                    <ul>
                        <li><strong>ë¡±í…Œì¼ í‚¤ì›Œë“œ:</strong> 3-4ë‹¨ì–´ ì¡°í•©ìœ¼ë¡œ ê²½ìŸì´ ë‚®ê³  ì „í™˜ìœ¨ì´ ë†’ìŠµë‹ˆë‹¤</li>
                        <li><strong>ì§€ì—­ í‚¤ì›Œë“œ:</strong> "ì§€ì—­ëª… + ì„œë¹„ìŠ¤"ë¡œ ë¡œì»¬ SEOì— íš¨ê³¼ì ì…ë‹ˆë‹¤</li>
                        <li><strong>ë¬¸ì œ í•´ê²° í‚¤ì›Œë“œ:</strong> "ë°©ë²•", "í•´ê²°", "íŒ" ë“±ì„ í¬í•¨í•œ í‚¤ì›Œë“œì…ë‹ˆë‹¤</li>
                        <li><strong>ê³„ì ˆì„± í‚¤ì›Œë“œ:</strong> ì‹œê¸°ë³„ íŠ¸ë Œë“œë¥¼ ê³ ë ¤í•œ í‚¤ì›Œë“œë¥¼ ì„ íƒí•˜ì„¸ìš”</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div class="login-modal" id="loginModal">
        <div class="login-modal-content">
            <h3>ğŸ” ë¡œê·¸ì¸</h3>
            <form class="login-form" id="loginForm">
                <input type="text" id="loginId" name="id" placeholder="ì•„ì´ë””" required>
                <input type="password" id="loginPassword" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸" required>
                <div class="login-form-buttons">
                    <button type="button" class="login-cancel-btn" onclick="closeLoginModal()">ì·¨ì†Œ</button>
                    <button type="submit" class="login-submit-btn">ë¡œê·¸ì¸</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-modal-content">
            <div class="settings-header">
                <h3>âš™ï¸ API ì„¤ì •</h3>
                <button class="close-modal" onclick="closeSettingsModal()">Ã—</button>
            </div>
            
            <div class="settings-body">
                <div class="api-section">
                    <h4>ğŸ”‘ ë„¤ì´ë²„ ê²€ìƒ‰ API ì„¤ì •</h4>
                    <div class="form-group">
                        <label for="naverClientId">ë„¤ì´ë²„ í´ë¼ì´ì–¸íŠ¸ ID</label>
                        <input type="text" id="naverClientId" name="naverClientId" placeholder="ë„¤ì´ë²„ ê°œë°œìì„¼í„°ì—ì„œ ë°œê¸‰ë°›ì€ í´ë¼ì´ì–¸íŠ¸ ID" required>
                    </div>
                    <div class="form-group">
                        <label for="naverClientSecret">ë„¤ì´ë²„ í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿</label>
                        <input type="password" id="naverClientSecret" name="naverClientSecret" placeholder="ë„¤ì´ë²„ ê°œë°œìì„¼í„°ì—ì„œ ë°œê¸‰ë°›ì€ í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿" required>
                    </div>
                </div>

                <div class="api-section">
                    <h4>ğŸ¤– Claude API ì„¤ì •</h4>
                    <div class="form-group">
                        <label for="claudeApiKey">Claude API í‚¤</label>
                        <input type="password" id="claudeApiKey" name="claudeApiKey" placeholder="Anthropic Consoleì—ì„œ ë°œê¸‰ë°›ì€ Claude API í‚¤" required>
                    </div>
                </div>

                <div class="api-section">
                    <h4>ğŸ”® Gemini API ì„¤ì •</h4>
                    <div class="form-group">
                        <label for="geminiApiKey">Gemini API í‚¤</label>
                        <input type="password" id="geminiApiKey" name="geminiApiKey" placeholder="Google AI Studioì—ì„œ ë°œê¸‰ë°›ì€ Gemini API í‚¤">
                    </div>
                    <div class="form-group">
                        <small style="color: #666; font-size: 12px;">
                            ğŸ’¡ Gemini APIëŠ” ëŒ€ì•ˆ AI ëª¨ë¸ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. Claude APIê°€ ì—†ê±°ë‚˜ ì‹¤íŒ¨ì‹œ ìë™ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
                        </small>
                    </div>
                </div>
            </div>
            
            <div class="settings-footer">
                <button class="save-settings-btn" onclick="saveApiSettings()">ğŸ’¾ ì„¤ì • ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- í‚¤ì›Œë“œ ì„ íƒ ëª¨ë‹¬ -->
    <div class="keyword-choice-modal" id="keywordChoiceModal">
        <div class="keyword-choice-modal-content">
            <div class="keyword-choice-header">
                <h3>ğŸ¯ í‚¤ì›Œë“œ ì ìš© ìœ„ì¹˜ ì„ íƒ</h3>
                <button class="close-modal" onclick="closeKeywordChoiceModal()">Ã—</button>
            </div>
            
            <div class="keyword-choice-body">
                <div class="selected-keyword-info">
                    <span class="keyword-label">ì„ íƒëœ í‚¤ì›Œë“œ:</span>
                    <span class="selected-keyword" id="selectedKeywordText"></span>
                </div>
                
                <div class="choice-description">
                    <p>ì´ í‚¤ì›Œë“œë¥¼ ì–´ëŠ ìœ„ì¹˜ì— ì ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
                </div>
                
                <div class="choice-buttons">
                    <button class="choice-btn main-search-btn" onclick="applyToMainSearch()">
                        <div class="btn-icon">ğŸ“„</div>
                        <div class="btn-content">
                            <div class="btn-title">ë³¸ë¬¸ ê²€ìƒ‰í‚¤ì›Œë“œ í•„ë“œ</div>
                            <div class="btn-description">ë©”ì¸ í™”ë©´ì˜ ê²€ìƒ‰ í‚¤ì›Œë“œì— ì…ë ¥í•˜ê³  ë¸”ë¡œê·¸ ê¸€ ê°€ì ¸ì˜¤ê¸° ì‹¤í–‰</div>
                        </div>
                    </button>
                    
                    <button class="choice-btn keyword-discovery-btn-choice" onclick="applyToKeywordDiscovery()">
                        <div class="btn-icon">ğŸ”</div>
                        <div class="btn-content">
                            <div class="btn-title">í‚¤ì›Œë“œë°œêµ´ í•„ë“œ</div>
                            <div class="btn-description">í‚¤ì›Œë“œë°œêµ´ í™”ë©´ì˜ ì…ë ¥ì°½ì— ì…ë ¥í•˜ê³  í‚¤ì›Œë“œ ë°œêµ´ ì¬ì‹¤í–‰</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ë¡œê·¸ì¸ ìƒíƒœ ê´€ë¦¬
        let currentUser = null;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', async function() {
            // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
            checkLoginStatus();
            
            // ê¸°ë³¸ ì‚¬ìš©ì ë°ì´í„° ì´ˆê¸°í™” (ìµœì´ˆ ì‹¤í–‰ì‹œ)
            await initializeDefaultUsers();
            try {
                const response = await fetch('/load-api-keys');
                const data = await response.json();
                
                if (data.success && data.apiData) {
                    document.getElementById('naverClientId').value = data.apiData.naverClientId || '';
                    document.getElementById('naverClientSecret').value = data.apiData.naverClientSecret || '';
                    document.getElementById('claudeApiKey').value = data.apiData.claudeApiKey || '';
                    document.getElementById('geminiApiKey').value = data.apiData.geminiApiKey || '';
                    
                    // API í‚¤ê°€ ì´ë¯¸ ì €ì¥ë˜ì–´ ìˆì–´ë„ ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì •ì€ ìˆ¨ê²¨ë‘ 
                    // ì‚¬ìš©ìê°€ í•„ìš”í•  ë•Œë§Œ 'ì„¤ì •ë³´ì´ê¸°' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í™•ì¸
                }
            } catch (error) {
                console.log('ì €ì¥ëœ API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.');
            }
        });

        // ê¸°ì¡´ ë¸”ë¡œê·¸ ìƒì„± í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°ë¨

        function showSettingsModal() {
            document.getElementById('settingsModal').style.display = 'block';
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        async function saveApiSettings() {
            const naverClientId = document.getElementById('naverClientId').value;
            const naverClientSecret = document.getElementById('naverClientSecret').value;
            const claudeApiKey = document.getElementById('claudeApiKey').value;
            const geminiApiKey = document.getElementById('geminiApiKey').value;

            try {
                const response = await fetch('/save-api-keys', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        naverClientId,
                        naverClientSecret,
                        claudeApiKey,
                        geminiApiKey
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    alert('âœ… API ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                    closeSettingsModal();
                } else {
                    alert('âŒ API ì„¤ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + data.error);
                }
            } catch (error) {
                console.error('API ì„¤ì • ì €ì¥ ì˜¤ë¥˜:', error);
                alert('âŒ API ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function displaySearchResults(searchResults) {
            const resultsList = document.getElementById('searchResultsList');
            resultsList.innerHTML = '';
            
            searchResults.forEach((item, index) => {
                const title = item.title.replace(/<[^>]*>/g, '');
                const description = item.description.replace(/<[^>]*>/g, '');
                
                const searchItem = document.createElement('div');
                searchItem.className = 'search-item';
                searchItem.innerHTML = `
                    <div class="search-item-title">${index + 1}. ${title}</div>
                    <div class="search-item-content">${description}</div>
                    <a href="${item.link}" target="_blank" class="search-item-link">ì›ë¬¸ ë³´ê¸° â†’</a>
                `;
                resultsList.appendChild(searchItem);
            });
        }

        async function copyToClipboard() {
            const copyBtn = document.getElementById('copyBtn');
            const resultContent = document.getElementById('resultContent');
            
            if (!resultContent.textContent) {
                alert('ë³µì‚¬í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            try {
                // ìµœì‹  ë¸Œë¼ìš°ì €ì˜ Clipboard API ì‚¬ìš©
                await navigator.clipboard.writeText(resultContent.textContent);
                
                // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
                copyBtn.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
                copyBtn.classList.add('copied');
                
                // 2ì´ˆ í›„ ì›ë˜ ìƒíƒœë¡œ ë³µì›
                setTimeout(() => {
                    copyBtn.textContent = 'ğŸ“‹ ë³µì‚¬í•˜ê¸°';
                    copyBtn.classList.remove('copied');
                }, 2000);
                
            } catch (err) {
                // Clipboard APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€ì²´ ë°©ë²• ì‚¬ìš©
                try {
                    const textArea = document.createElement('textarea');
                    textArea.value = resultContent.textContent;
                    textArea.style.position = 'fixed';
                    textArea.style.top = '-9999px';
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    
                    copyBtn.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
                    copyBtn.classList.add('copied');
                    
                    setTimeout(() => {
                        copyBtn.textContent = 'ğŸ“‹ ë³µì‚¬í•˜ê¸°';
                        copyBtn.classList.remove('copied');
                    }, 2000);
                    
                } catch (fallbackErr) {
                    console.error('ë³µì‚¬ ì‹¤íŒ¨:', fallbackErr);
                    alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ì—¬ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // AI í”„ë¡¬í”„íŠ¸ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        let currentPrompts = [];

        async function showPromptModal() {
            await loadPrompts();
            showPromptListView();
            document.getElementById('promptModal').style.display = 'block';
        }

        function closePromptModal() {
            document.getElementById('promptModal').style.display = 'none';
        }

        function showPromptListView() {
            document.getElementById('promptListView').style.display = 'block';
            document.getElementById('promptForm').classList.remove('show');
        }

        function showNewPromptForm() {
            document.getElementById('promptFormTitle').textContent = 'ğŸ†• ìƒˆ AI í”„ë¡¬í”„íŠ¸ ë“±ë¡';
            document.getElementById('promptSubmitBtn').textContent = 'ì €ì¥';
            document.getElementById('promptFormElement').reset();
            document.getElementById('promptId').value = '';
            
            document.getElementById('promptListView').style.display = 'none';
            document.getElementById('promptForm').classList.add('show');
        }

        function editPrompt(prompt) {
            document.getElementById('promptFormTitle').textContent = 'âœï¸ AI í”„ë¡¬í”„íŠ¸ ìˆ˜ì •';
            document.getElementById('promptSubmitBtn').textContent = 'ìˆ˜ì •';
            document.getElementById('promptId').value = prompt.id;
            document.getElementById('promptTitle').value = prompt.title;
            document.getElementById('promptContent').value = prompt.content;
            
            document.getElementById('promptListView').style.display = 'none';
            document.getElementById('promptForm').classList.add('show');
        }

        function cancelPromptForm() {
            showPromptListView();
        }

        async function loadPrompts() {
            try {
                const response = await fetch('/api/prompts');
                const data = await response.json();
                
                if (data.success) {
                    currentPrompts = data.prompts;
                    displayPrompts();
                }
            } catch (error) {
                console.error('í”„ë¡¬í”„íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
                currentPrompts = [];
                displayPrompts();
            }
        }

        function displayPrompts() {
            const promptList = document.getElementById('promptList');
            
            if (currentPrompts.length === 0) {
                promptList.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">ì €ì¥ëœ AI í”„ë¡¬í”„íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            promptList.innerHTML = currentPrompts.map(prompt => `
                <div class="prompt-item" onclick="selectPrompt('${prompt.id}')">
                    <div class="prompt-item-title">${prompt.title}</div>
                    <div class="prompt-item-content">${prompt.content}</div>
                    <div style="margin-top: 10px;">
                        <button type="button" class="prompt-btn" onclick="event.stopPropagation(); editPrompt(${JSON.stringify(prompt).replace(/"/g, '&quot;')})" style="margin-right: 10px; padding: 4px 8px; font-size: 12px;">ìˆ˜ì •</button>
                        <button type="button" class="prompt-btn" onclick="event.stopPropagation(); deletePrompt('${prompt.id}')" style="background: #dc3545; padding: 4px 8px; font-size: 12px;">ì‚­ì œ</button>
                    </div>
                </div>
            `).join('');
        }

        function selectPrompt(promptId) {
            const prompt = currentPrompts.find(p => p.id === promptId);
            if (prompt) {
                document.getElementById('aiPrompt').value = prompt.content;
                closePromptModal();
            }
        }

        async function deletePrompt(promptId) {
            if (!confirm('ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/prompts/${promptId}`, {
                    method: 'DELETE'
                });
                
                const data = await response.json();
                
                if (data.success) {
                    await loadPrompts();
                } else {
                    alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í”„ë¡¬í”„íŠ¸ í¼ ì œì¶œ ì²˜ë¦¬
        document.getElementById('promptFormElement').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            
            const isEdit = !!data.promptId;
            const url = isEdit ? `/api/prompts/${data.promptId}` : '/api/prompts';
            const method = isEdit ? 'PUT' : 'POST';
            
            try {
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        title: data.title,
                        content: data.content
                    })
                });
                
                const responseData = await response.json();
                
                if (responseData.success) {
                    await loadPrompts();
                    showPromptListView();
                } else {
                    alert(responseData.error || 'ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        });

        // ë¡œê·¸ì¸ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function checkLoginStatus() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateLoginUI();
            }
        }

        function updateLoginUI() {
            const loginArea = document.getElementById('loginArea');
            
            if (currentUser) {
                loginArea.innerHTML = `
                    <span class="user-info">ğŸ‘¤ ${currentUser.id}ë‹˜</span>
                    <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
                    <button class="settings-btn" id="settingsBtn" onclick="showSettingsModal()" title="ì„¤ì •">âš™ï¸</button>
                `;
            } else {
                loginArea.innerHTML = `
                    <button class="login-btn" onclick="showLoginModal()">ğŸ‘¤ ë¡œê·¸ì¸</button>
                    <button class="settings-btn" id="settingsBtn" onclick="showSettingsModal()" title="ì„¤ì •">âš™ï¸</button>
                `;
            }
        }

        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'block';
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('loginForm').reset();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateLoginUI();
        }

        async function initializeDefaultUsers() {
            try {
                await fetch('/api/init-users', {
                    method: 'POST'
                });
                console.log('ê¸°ë³¸ ì‚¬ìš©ì ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ');
            } catch (error) {
                console.error('ê¸°ë³¸ ì‚¬ìš©ì ë°ì´í„° ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            }
        }

        // ë¡œê·¸ì¸ í¼ ì œì¶œ ì²˜ë¦¬
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // ëª…ì‹œì ìœ¼ë¡œ idì™€ passwordë§Œ ìˆ˜ì§‘
            const id = document.getElementById('loginId').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!id || !password) {
                alert('ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const data = {
                id: id,
                password: password
            };
            
            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentUser = result.user;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    updateLoginUI();
                    closeLoginModal();
                    alert(`${currentUser.id}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`);
                } else {
                    alert(result.error || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
                alert('ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        });

        // ê°€ì ¸ì˜¨ ë¸”ë¡œê·¸ ê¸€ ì €ì¥ ë³€ìˆ˜
        let fetchedBlogPosts = [];

        // ì§ì ‘ URLì—ì„œ ê¸€ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
        async function fetchFromDirectUrl() {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì„ í•œ í›„ì— ì‚¬ìš©í•˜ì‹­ì‹œì˜¤');
                return;
            }

            const urlInput = document.getElementById('directUrlInput');
            const url = urlInput.value.trim();
            
            if (!url) {
                alert('URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë„¤ì´ë²„ ë¸”ë¡œê·¸ URL í˜•ì‹ ê²€ì¦
            if (!url.includes('blog.naver.com') && !url.includes('m.blog.naver.com')) {
                alert('ë„¤ì´ë²„ ë¸”ë¡œê·¸ URLë§Œ ì§€ì›ë©ë‹ˆë‹¤.');
                return;
            }

            const fetchBtn = document.querySelector('.url-fetch-btn');
            const resultContent = document.getElementById('resultContent');
            const resultContainer = document.getElementById('result');

            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© ìƒíƒœ
            fetchBtn.disabled = true;
            fetchBtn.innerHTML = 'ğŸ”„ ê°€ì ¸ì˜¤ëŠ” ì¤‘...';
            
            resultContent.innerHTML = '<div style="text-align: center; padding: 20px;">ğŸ”„ URLì—ì„œ ë¸”ë¡œê·¸ ê¸€ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>';
            resultContainer.style.display = 'block';

            try {
                const response = await fetch('/api/scrape-blog-content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        url: url,
                        title: 'URLì—ì„œ ê°€ì ¸ì˜¨ ê¸€'
                    })
                });

                const data = await response.json();

                if (data.success && data.content) {
                    // ìŠ¤í¬ë©ëœê¸€ ì„¹ì…˜ì— ì§ì ‘ í‘œì‹œ
                    const formattedContent = formatTextWithLineBreaks(data.content);
                    resultContent.innerHTML = formattedContent;
                    
                    // AI ìƒì„± ë²„íŠ¼ë“¤ í‘œì‹œ
                    const aiGenerateBtn = document.getElementById('aiGenerateBtn');
                    const geminiGenerateBtn = document.getElementById('geminiGenerateBtn');
                    const aiPromptSection = document.getElementById('aiPromptSection');
                    aiGenerateBtn.style.display = 'block';
                    geminiGenerateBtn.style.display = 'block';
                    aiPromptSection.style.display = 'block';
                    
                    // URL ì…ë ¥ì°½ ì´ˆê¸°í™”
                    urlInput.value = '';
                    
                    console.log('[INFO] ì§ì ‘ URLì—ì„œ ê¸€ ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ:', data.message || '');
                    console.log(`[INFO] ê°€ì ¸ì˜¨ ê¸€ ê¸¸ì´: ${data.content.length}ì, ì†ŒìŠ¤: ${data.source}`);
                } else {
                    throw new Error(data.error || 'ì»¨í…ì¸ ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ì§ì ‘ URL ê¸€ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);
                resultContent.innerHTML = '<div style="text-align: center; color: red;">ì§ì ‘ URLì—ì„œ ê¸€ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                fetchBtn.disabled = false;
                fetchBtn.innerHTML = 'ğŸ”— URLì—ì„œ ê¸€ ê°€ì ¸ì˜¤ê¸°';
            }
        }

        // ë¸”ë¡œê·¸ê¸€ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
        async function fetchBlogPosts() {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì„ í•œ í›„ì— ì‚¬ìš©í•˜ì‹­ì‹œì˜¤');
                return;
            }

            const keyword = document.getElementById('keyword').value;
            if (!keyword.trim()) {
                alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const fetchBtn = document.querySelector('.fetch-blogs-btn');
            const resultsContainer = document.getElementById('blogPostsResults');
            const resultsList = document.getElementById('blogPostsList');

            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© ìƒíƒœ
            fetchBtn.disabled = true;
            fetchBtn.innerHTML = 'ğŸ”„ ê°€ì ¸ì˜¤ëŠ” ì¤‘...';
            
            resultsList.innerHTML = '<div style="text-align: center; padding: 20px;">ë¸”ë¡œê·¸ ê¸€ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>';
            resultsContainer.style.display = 'block';

            try {
                const response = await fetch('/api/fetch-blog-posts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ keyword: keyword })
                });

                const data = await response.json();
                
                if (data.success) {
                    fetchedBlogPosts = data.blogPosts; // ë¸”ë¡œê·¸ ê¸€ ë°ì´í„° ì €ì¥
                    displayBlogPosts(data.blogPosts);
                } else {
                    resultsList.innerHTML = '<div style="text-align: center; color: red;">ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: ' + data.error + '</div>';
                }
            } catch (error) {
                console.error('ë¸”ë¡œê·¸ê¸€ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);
                resultsList.innerHTML = '<div style="text-align: center; color: red;">ë¸”ë¡œê·¸ê¸€ ê°€ì ¸ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                fetchBtn.disabled = false;
                fetchBtn.innerHTML = 'ğŸ“„ ë¸”ë¡œê·¸ê¸€ ê°€ì ¸ì˜¤ê¸°';
            }
        }

        function displayBlogPosts(blogPosts) {
            const resultsList = document.getElementById('blogPostsList');
            
            if (blogPosts.length === 0) {
                resultsList.innerHTML = '<div style="text-align: center; color: #666;">ê²€ìƒ‰ëœ ë¸”ë¡œê·¸ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                document.getElementById('blogSelectionButtons').style.display = 'none';
                return;
            }

            let html = '';
            blogPosts.forEach((post, index) => {
                html += `
                    <div class="blog-post-item">
                        <div class="blog-post-header">
                            <input type="radio" name="selectedBlog" value="${index}" id="blog_${index}" ${index === 0 ? 'checked' : ''}>
                            <label for="blog_${index}" class="blog-post-title">${index + 1}. ${post.title}</label>
                        </div>
                        <div class="blog-post-content">${post.content}</div>
                        <a href="${post.link}" target="_blank" class="blog-post-link">ì›ë¬¸ ë³´ê¸° â†’</a>
                    </div>
                `;
            });
            
            resultsList.innerHTML = html;
            
            // ë¸”ë¡œê·¸ ì„ íƒ ë²„íŠ¼ë“¤ í‘œì‹œ
            if (blogPosts.length > 0) {
                const blogSelectionButtons = document.getElementById('blogSelectionButtons');
                blogSelectionButtons.style.display = 'block';
            }
        }

        async function scrapeSelectedBlog() {
            // ì„ íƒëœ ë¼ë””ì˜¤ ë²„íŠ¼ ì°¾ê¸°
            const selectedRadio = document.querySelector('input[name="selectedBlog"]:checked');
            if (!selectedRadio) {
                alert('ë¨¼ì € ê°€ì ¸ì˜¬ ë¸”ë¡œê·¸ ê¸€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const index = parseInt(selectedRadio.value);
            
            if (fetchedBlogPosts.length === 0) {
                alert('ë¨¼ì € ë¸”ë¡œê·¸ ê¸€ì„ ê°€ì ¸ì™€ì£¼ì„¸ìš”.');
                return;
            }

            if (index >= fetchedBlogPosts.length) {
                alert(`ì„ íƒëœ ë¸”ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤. ì´ ${fetchedBlogPosts.length}ê°œì˜ ë¸”ë¡œê·¸ê°€ ìˆìŠµë‹ˆë‹¤.`);
                return;
            }
            
            const selectedPost = fetchedBlogPosts[index];
            const resultContent = document.getElementById('resultContent');
            const result = document.getElementById('result');

            // ë²„íŠ¼ ë¹„í™œì„±í™”
            const button = document.querySelector('.blog-select-btn');
            button.disabled = true;
            button.innerHTML = 'ğŸ”„ ê°€ì ¸ì˜¤ëŠ” ì¤‘...';
            
            // ë¡œë”© í‘œì‹œ
            resultContent.textContent = `ì„ íƒëœ ê¸€ì˜ ì›ë¬¸ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...`;
            result.style.display = 'block';

            try {
                // ë¨¼ì € ì›ë¬¸ ìŠ¤í¬ë˜í•‘ ì‹œë„
                const scrapingResponse = await fetch('/api/scrape-blog-content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        url: selectedPost.link,
                        title: selectedPost.title
                    })
                });
                
                const scrapingData = await scrapingResponse.json();
                
                // ìŠ¤í¬ë˜í•‘ì´ ì„±ê³µí•˜ê³  ì¶©ë¶„í•œ ì½˜í…ì¸ ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
                if (scrapingData.success && scrapingData.source === 'direct_scraping' && scrapingData.length > 200) {
                    // ì œëª©ê³¼ ë³¸ë¬¸ì„ í•¨ê»˜ í‘œì‹œ
                    const fullContent = `# ${selectedPost.title}\n\n${scrapingData.content}`;
                    const formattedContent = formatTextWithLineBreaks(fullContent);
                    resultContent.textContent = formattedContent;
                    if (scrapingData.message) {
                        resultContent.textContent += `\n\nâ€» ${scrapingData.message}`;
                    }
                } else {
                    // ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨ ì‹œ í™•ì¥ ê²€ìƒ‰ ë°©ì‹ ì‚¬ìš©
                    console.log('[INFO] ì›ë¬¸ ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨, í™•ì¥ ê²€ìƒ‰ ì‚¬ìš©');
                    
                    const response = await fetch('/api/fetch-full-content', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ 
                            url: selectedPost.link,
                            title: selectedPost.title
                        })
                    });

                    const data = await response.json();
                    
                    if (data.success) {
                        // ì œëª©ê³¼ ë³¸ë¬¸ì„ í•¨ê»˜ í‘œì‹œ
                        const fullContent = `# ${selectedPost.title}\n\n${data.content}`;
                        const formattedContent = formatTextWithLineBreaks(fullContent);
                        resultContent.textContent = formattedContent;
                        if (data.message) {
                            resultContent.textContent += `\n\nâ€» ${data.message}`;
                        }
                    } else {
                        // ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ ìš”ì•½ë³¸ì— ì œëª© ì¶”ê°€
                        const fullContent = `# ${selectedPost.title}\n\n${selectedPost.content}`;
                        const formattedSummary = formatTextWithLineBreaks(fullContent);
                        resultContent.textContent = `ì„ íƒëœ ê¸€ ì›ë¬¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìš”ì•½ë³¸ì„ í‘œì‹œí•©ë‹ˆë‹¤:\n\n${formattedSummary}`;
                    }
                }
                
                // AI ìƒì„± ë²„íŠ¼ë“¤ í‘œì‹œ
                const aiGenerateBtn = document.getElementById('aiGenerateBtn');
                const geminiGenerateBtn = document.getElementById('geminiGenerateBtn');
                const aiPromptSection = document.getElementById('aiPromptSection');
                aiGenerateBtn.style.display = 'block';
                geminiGenerateBtn.style.display = 'block';
                aiPromptSection.style.display = 'block';
                
                // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                result.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('ì›ë¬¸ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ ì‹œ ê¸°ì¡´ ìš”ì•½ë³¸ì— ì œëª© ì¶”ê°€
                const fullContent = `# ${selectedPost.title}\n\n${selectedPost.content}`;
                const formattedErrorSummary = formatTextWithLineBreaks(fullContent);
                resultContent.textContent = `ì„ íƒëœ ê¸€ ê°€ì ¸ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìš”ì•½ë³¸ì„ í‘œì‹œí•©ë‹ˆë‹¤:\n\n${formattedErrorSummary}`;
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                button.disabled = false;
                button.innerHTML = 'ğŸ“„ ì„ íƒëœë‚´ìš© ê°€ì ¸ì˜¤ê¸°';
            }
        }

        // ë¬¸ì¥ ëì— ì¤„ë°”ê¿ˆ ì¶”ê°€ í•¨ìˆ˜
        function formatTextWithLineBreaks(text) {
            if (!text) return text;
            
            // í•œêµ­ì–´ ë¬¸ì¥ ë íŒ¨í„´ë“¤
            const sentenceEndings = [
                /ë‹¤\./g,      // ë‹¤.
                /ë‹¤\s/g,      // ë‹¤ (ê³µë°±)
                /ì„\./g,      // ì„.
                /ì„\s/g,      // ì„ (ê³µë°±)
                /ì–´\./g,      // ì–´.
                /ì–´\s/g,      // ì–´ (ê³µë°±)
                /ìš”\./g,      // ìš”.
                /ìš”\s/g,      // ìš” (ê³µë°±)
                /ìŒ\./g,      // ìŒ.
                /ìŒ\s/g,      // ìŒ (ê³µë°±)
                /ì£ \./g,      // ì£ .
                /ì£ \s/g,      // ì£  (ê³µë°±)
                /ë„¤\./g,      // ë„¤.
                /ë„¤\s/g,      // ë„¤ (ê³µë°±)
                /ê²Œ\./g,      // ê²Œ.
                /ê²Œ\s/g,      // ê²Œ (ê³µë°±)
                /ì§€\./g,      // ì§€.
                /ì§€\s/g,      // ì§€ (ê³µë°±)
                /ë‹ˆ\./g,      // ë‹ˆ.
                /ë‹ˆ\s/g,      // ë‹ˆ (ê³µë°±)
                /ê¹Œ\./g,      // ê¹Œ.
                /ê¹Œ\s/g,      // ê¹Œ (ê³µë°±)
                /ì•¼\./g,      // ì•¼.
                /ì•¼\s/g,      // ì•¼ (ê³µë°±)
                /ì•„\./g,      // ì•„.
                /ì•„\s/g,      // ì•„ (ê³µë°±)
                /!\s/g,       // ! (ëŠë‚Œí‘œ)
                /\?\s/g,      // ? (ë¬¼ìŒí‘œ)
                /\.\.\.\s/g   // ... (ë§ì¤„ì„í‘œ)
            ];
            
            let formattedText = text;
            
            // ê° ë¬¸ì¥ ë íŒ¨í„´ì— ëŒ€í•´ ì¤„ë°”ê¿ˆ ì¶”ê°€
            sentenceEndings.forEach(pattern => {
                formattedText = formattedText.replace(pattern, (match) => {
                    // ë§ˆì§€ë§‰ ë¬¸ìê°€ ê³µë°±ì´ë©´ ì œê±°í•˜ê³  ì¤„ë°”ê¿ˆ ì¶”ê°€
                    const trimmedMatch = match.trim();
                    return trimmedMatch + '\n\n';
                });
            });
            
            // ì—°ì†ëœ ì¤„ë°”ê¿ˆ ì •ë¦¬ (3ê°œ ì´ìƒì˜ ì¤„ë°”ê¿ˆì„ 2ê°œë¡œ)
            formattedText = formattedText.replace(/\n{3,}/g, '\n\n');
            
            // ì•ë’¤ ê³µë°± ì œê±°
            formattedText = formattedText.trim();
            
            return formattedText;
        }

        // ê°œë³„ ë¸”ë¡œê·¸ ìŠ¤í¬ë˜í•‘ í•¨ìˆ˜
        async function scrapeBlogPost(index) {
            if (fetchedBlogPosts.length === 0) {
                alert('ë¨¼ì € ë¸”ë¡œê·¸ ê¸€ì„ ê°€ì ¸ì™€ì£¼ì„¸ìš”.');
                return;
            }

            if (index >= fetchedBlogPosts.length) {
                alert(`${index + 1}ë²ˆì§¸ ë¸”ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤. ì´ ${fetchedBlogPosts.length}ê°œì˜ ë¸”ë¡œê·¸ê°€ ìˆìŠµë‹ˆë‹¤.`);
                return;
            }
            
            const selectedPost = fetchedBlogPosts[index];
            const resultContent = document.getElementById('resultContent');
            const result = document.getElementById('result');

            // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
            const buttons = document.querySelectorAll('.blog-select-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
            });
            
            // ë¡œë”© í‘œì‹œ
            resultContent.textContent = `${index + 1}ë²ˆì§¸ ê¸€ì˜ ì›ë¬¸ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...`;
            result.style.display = 'block';

            try {
                // ë¨¼ì € ì›ë¬¸ ìŠ¤í¬ë˜í•‘ ì‹œë„
                const scrapingResponse = await fetch('/api/scrape-blog-content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        url: selectedPost.link,
                        title: selectedPost.title
                    })
                });
                
                const scrapingData = await scrapingResponse.json();
                
                // ìŠ¤í¬ë˜í•‘ì´ ì„±ê³µí•˜ê³  ì¶©ë¶„í•œ ì½˜í…ì¸ ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
                if (scrapingData.success && scrapingData.source === 'direct_scraping' && scrapingData.length > 200) {
                    // ë¬¸ì¥ ëì— ì¤„ë°”ê¿ˆì„ ì¶”ê°€í•˜ì—¬ í‘œì‹œ
                    const formattedContent = formatTextWithLineBreaks(scrapingData.content);
                    resultContent.textContent = formattedContent;
                    if (scrapingData.message) {
                        resultContent.textContent += `\n\nâ€» ${scrapingData.message}`;
                    }
                } else {
                    // ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨ ì‹œ í™•ì¥ ê²€ìƒ‰ ë°©ì‹ ì‚¬ìš©
                    console.log('[INFO] ì›ë¬¸ ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨, í™•ì¥ ê²€ìƒ‰ ì‚¬ìš©');
                    
                    const response = await fetch('/api/fetch-full-content', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ 
                            url: selectedPost.link,
                            title: selectedPost.title
                        })
                    });

                    const data = await response.json();
                    
                    if (data.success) {
                        // í™•ì¥ ê²€ìƒ‰ ê²°ê³¼ì—ë„ ì¤„ë°”ê¿ˆ í˜•ì‹ ì ìš©
                        const formattedContent = formatTextWithLineBreaks(data.content);
                        resultContent.textContent = formattedContent;
                        if (data.message) {
                            resultContent.textContent += `\n\nâ€» ${data.message}`;
                        }
                    } else {
                        // ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ ìš”ì•½ë³¸ë„ ì¤„ë°”ê¿ˆ í˜•ì‹ ì ìš©
                        const formattedSummary = formatTextWithLineBreaks(selectedPost.content);
                        resultContent.textContent = `${index + 1}ë²ˆì§¸ ê¸€ ì›ë¬¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìš”ì•½ë³¸ì„ í‘œì‹œí•©ë‹ˆë‹¤:\n\n${formattedSummary}`;
                    }
                }
                
                // AI ìƒì„± ë²„íŠ¼ë“¤ í‘œì‹œ
                const aiGenerateBtn = document.getElementById('aiGenerateBtn');
                const geminiGenerateBtn = document.getElementById('geminiGenerateBtn');
                const aiPromptSection = document.getElementById('aiPromptSection');
                aiGenerateBtn.style.display = 'block';
                geminiGenerateBtn.style.display = 'block';
                aiPromptSection.style.display = 'block';
                
                // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                result.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('ì›ë¬¸ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ ì‹œ ê¸°ì¡´ ìš”ì•½ë³¸ë„ ì¤„ë°”ê¿ˆ í˜•ì‹ ì ìš©
                const formattedErrorSummary = formatTextWithLineBreaks(selectedPost.content);
                resultContent.textContent = `${index + 1}ë²ˆì§¸ ê¸€ ê°€ì ¸ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìš”ì•½ë³¸ì„ í‘œì‹œí•©ë‹ˆë‹¤:\n\n${formattedErrorSummary}`;
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                const buttons = document.querySelectorAll('.blog-select-btn');
                buttons.forEach((btn, btnIndex) => {
                    btn.disabled = false;
                    // ê° ë²„íŠ¼ì˜ ì›ë˜ í…ìŠ¤íŠ¸ ë³µì›
                    const buttonTexts = [
                        'ğŸ“ ì²«ë²ˆì§¸ë‚´ìš©ê°€ì ¸ì˜¤ê¸°',
                        'ğŸ“„ ë‘ë²ˆì§¸ë‚´ìš©ê°€ì ¸ì˜¤ê¸°', 
                        'ğŸ“‹ ì„¸ë²ˆì§¸ë‚´ìš©ê°€ì ¸ì˜¤ê¸°',
                        'ğŸ“š ì²˜ìŒ3ê°œëª¨ë‘ê°€ì ¸ì˜¤ê¸°'
                    ];
                    if (btnIndex < buttonTexts.length) {
                        btn.innerHTML = buttonTexts[btnIndex];
                    }
                });
            }
        }
        
        // ì—¬ëŸ¬ ë¸”ë¡œê·¸ ë™ì‹œ ìŠ¤í¬ë˜í•‘ í•¨ìˆ˜
        async function scrapeMultipleBlogs() {
            if (fetchedBlogPosts.length === 0) {
                alert('ë¨¼ì € ë¸”ë¡œê·¸ ê¸€ì„ ê°€ì ¸ì™€ì£¼ì„¸ìš”.');
                return;
            }
            
            const resultContent = document.getElementById('resultContent');
            const result = document.getElementById('result');
            
            // ìµœëŒ€ 3ê°œ ë˜ëŠ” ì‚¬ìš© ê°€ëŠ¥í•œ ë¸”ë¡œê·¸ ìˆ˜ë§Œí¼
            const blogsToScrape = Math.min(3, fetchedBlogPosts.length);
            
            // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
            const buttons = document.querySelectorAll('.blog-select-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
            });
            
            // ë§ˆì§€ë§‰ ë²„íŠ¼ì„ ë¡œë”© ìƒíƒœë¡œ
            const allBlogsBtn = buttons[buttons.length - 1];
            allBlogsBtn.innerHTML = 'ğŸ”„ ëª¨ë‘ ê°€ì ¸ì˜¤ëŠ” ì¤‘...';
            
            // ë¡œë”© í‘œì‹œ
            resultContent.textContent = `ì²˜ìŒ ${blogsToScrape}ê°œ ë¸”ë¡œê·¸ì˜ ì›ë¬¸ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...`;
            result.style.display = 'block';
            
            try {
                let combinedContent = '';
                let successCount = 0;
                
                for (let i = 0; i < blogsToScrape; i++) {
                    const currentPost = fetchedBlogPosts[i];
                    resultContent.textContent = `${i + 1}ë²ˆì§¸ ë¸”ë¡œê·¸ ê°€ì ¸ì˜¤ëŠ” ì¤‘... (${i + 1}/${blogsToScrape})`;
                    
                    try {
                        // ì›ë¬¸ ìŠ¤í¬ë˜í•‘ ì‹œë„
                        const scrapingResponse = await fetch('/api/scrape-blog-content', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ 
                                url: currentPost.link,
                                title: currentPost.title
                            })
                        });
                        
                        const scrapingData = await scrapingResponse.json();
                        
                        let blogContent = '';
                        
                        if (scrapingData.success && scrapingData.source === 'direct_scraping' && scrapingData.length > 200) {
                            blogContent = formatTextWithLineBreaks(scrapingData.content);
                            successCount++;
                        } else {
                            // ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨ ì‹œ í™•ì¥ ê²€ìƒ‰ ì‹œë„
                            try {
                                const response = await fetch('/api/fetch-full-content', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: JSON.stringify({ 
                                        url: currentPost.link,
                                        title: currentPost.title
                                    })
                                });
                                
                                const data = await response.json();
                                
                                if (data.success) {
                                    blogContent = formatTextWithLineBreaks(data.content);
                                    successCount++;
                                } else {
                                    // ëŒ€ì²´ ìš”ì•½ë³¸ ì‚¬ìš©
                                    blogContent = formatTextWithLineBreaks(currentPost.content);
                                }
                            } catch (error) {
                                blogContent = formatTextWithLineBreaks(currentPost.content);
                            }
                        }
                        
                        // ê° ë¸”ë¡œê·¸ ë‚´ìš©ì„ êµ¬ë¶„ìì™€ í•¨ê»˜ ì¶”ê°€
                        combinedContent += `\n\n=== ${i + 1}ë²ˆì§¸ ë¸”ë¡œê·¸: ${currentPost.title.replace(/<[^>]*>/g, '')} ===\n\n`;
                        combinedContent += blogContent + '\n\n';
                        
                    } catch (error) {
                        console.error(`${i + 1}ë²ˆì§¸ ë¸”ë¡œê·¸ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:`, error);
                        // ì‹¤íŒ¨í•œ ê²½ìš° ìš”ì•½ë³¸ìœ¼ë¡œ ëŒ€ì²´
                        combinedContent += `\n\n=== ${i + 1}ë²ˆì§¸ ë¸”ë¡œê·¸: ${currentPost.title.replace(/<[^>]*>/g, '')} (ìš”ì•½ë³¸) ===\n\n`;
                        combinedContent += formatTextWithLineBreaks(currentPost.content) + '\n\n';
                    }
                }
                
                // ìµœì¢… ê²°ê³¼ í‘œì‹œ
                const finalContent = `ì²˜ìŒ ${blogsToScrape}ê°œ ë¸”ë¡œê·¸ ë‚´ìš© (ì›ë¬¸ ${successCount}ê°œ, ìš”ì•½ ${blogsToScrape - successCount}ê°œ)\n` + combinedContent.trim();
                resultContent.textContent = finalContent;
                
                // AI ìƒì„± ë²„íŠ¼ë“¤ í‘œì‹œ
                const aiGenerateBtn = document.getElementById('aiGenerateBtn');
                const geminiGenerateBtn = document.getElementById('geminiGenerateBtn');
                const aiPromptSection = document.getElementById('aiPromptSection');
                aiGenerateBtn.style.display = 'block';
                geminiGenerateBtn.style.display = 'block';
                aiPromptSection.style.display = 'block';
                
                // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                result.scrollIntoView({ behavior: 'smooth' });
                
                console.log(`[INFO] ë‹¤ì¤‘ ë¸”ë¡œê·¸ ìŠ¤í¬ë˜í•‘ ì™„ë£Œ: ${successCount}/${blogsToScrape} ì„±ê³µ`);
                
            } catch (error) {
                console.error('ë‹¤ì¤‘ ë¸”ë¡œê·¸ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);
                resultContent.textContent = `ë‹¤ì¤‘ ë¸”ë¡œê·¸ ê°€ì ¸ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`;
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                const buttons = document.querySelectorAll('.blog-select-btn');
                buttons.forEach((btn, btnIndex) => {
                    btn.disabled = false;
                    const buttonTexts = [
                        'ğŸ“ ì²«ë²ˆì§¸ë‚´ìš©ê°€ì ¸ì˜¤ê¸°',
                        'ğŸ“„ ë‘ë²ˆì§¸ë‚´ìš©ê°€ì ¸ì˜¤ê¸°', 
                        'ğŸ“‹ ì„¸ë²ˆì§¸ë‚´ìš©ê°€ì ¸ì˜¤ê¸°',
                        'ğŸ“š ì²˜ìŒ3ê°œëª¨ë‘ê°€ì ¸ì˜¤ê¸°'
                    ];
                    if (btnIndex < buttonTexts.length) {
                        btn.innerHTML = buttonTexts[btnIndex];
                    }
                });
            }
        }

        function getCompetitionText(competition) {
            switch(competition) {
                case 'low': return 'ë‚®ìŒ';
                case 'medium': return 'ì¤‘ê°„';
                case 'high': return 'ë†’ìŒ';
                default: return 'ì¤‘ê°„';
            }
        }

        let selectedKeywordForChoice = '';

        function selectKeyword(keyword) {
            // ì„ íƒëœ í‚¤ì›Œë“œë¥¼ ì €ì¥í•˜ê³  ëª¨ë‹¬ì°½ í‘œì‹œ
            selectedKeywordForChoice = keyword;
            document.getElementById('selectedKeywordText').textContent = keyword;
            document.getElementById('keywordChoiceModal').style.display = 'block';
        }

        function closeKeywordChoiceModal() {
            document.getElementById('keywordChoiceModal').style.display = 'none';
            selectedKeywordForChoice = '';
        }

        function applyToMainSearch() {
            if (selectedKeywordForChoice) {
                // ë³¸ë¬¸ ê²€ìƒ‰í‚¤ì›Œë“œì°½ì— ì…ë ¥í•˜ê³  ë¸”ë¡œê·¸ ê¸€ ê°€ì ¸ì˜¤ê¸° ì‹¤í–‰
                document.getElementById('keyword').value = selectedKeywordForChoice;
                closeKeywordChoiceModal();
                // í‚¤ì›Œë“œë°œêµ´ í™”ë©´ì—ì„œ ë©”ì¸ìœ¼ë¡œ ì´ë™
                if (document.getElementById('keywordDiscoveryPage').style.display === 'block') {
                    hideKeywordDiscovery();
                }
                // ìë™ìœ¼ë¡œ ë¸”ë¡œê·¸ ê¸€ ê°€ì ¸ì˜¤ê¸° ì‹¤í–‰
                setTimeout(() => {
                    fetchBlogs();
                }, 300);
            }
        }

        function applyToKeywordDiscovery() {
            if (selectedKeywordForChoice) {
                // í‚¤ì›Œë“œë°œêµ´ ì…ë ¥ì°½ì— ì…ë ¥í•˜ê³  í‚¤ì›Œë“œ ë°œêµ´ ì¬ì‹¤í–‰
                document.getElementById('keywordDiscoveryInput').value = selectedKeywordForChoice;
                closeKeywordChoiceModal();
                // ìë™ìœ¼ë¡œ í‚¤ì›Œë“œ ë°œêµ´ ì‹¤í–‰
                setTimeout(() => {
                    startKeywordDiscovery();
                }, 300);
            }
        }
        
        // AIë¡œ ê¸€ìƒì„±í•˜ê¸° í•¨ìˆ˜ (ìŠ¤í¬ë©ëœ ê¸€ ê¸°ë°˜)
        async function generateAIContent() {
            const aiGenerateBtn = document.getElementById('aiGenerateBtn');
            const aiResult = document.getElementById('aiResult');
            const aiResultContent = document.getElementById('aiResultContent');
            const resultContent = document.getElementById('resultContent');
            
            if (!resultContent.textContent) {
                alert('ë¨¼ì € ìŠ¤í¬ë©ëœ ê¸€ì´ ìˆì–´ì•¼ AIë¡œ ê¸€ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© ìƒíƒœ
            aiGenerateBtn.disabled = true;
            aiGenerateBtn.innerHTML = 'ğŸ”„ AIê°€ ê¸€ì„ ìƒì„±í•˜ëŠ” ì¤‘...';
            
            // AI ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            aiResult.style.display = 'block';
            
            // ì²«ë²ˆì§¸ ìƒì„±ëœê¸€ ê¸°ë°˜ ì¶”ê°€ ìƒì„± ë²„íŠ¼ë“¤ í‘œì‹œ
            const secondGenerationButtons = document.getElementById('secondGenerationButtons');
            secondGenerationButtons.style.display = 'block';
            aiResultContent.textContent = 'AIê°€ ìŠ¤í¬ë©ëœ ê¸€ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ë¸”ë¡œê·¸ ê¸€ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...';
            
            try {
                // í˜„ì¬ í‚¤ì›Œë“œ ê°€ì ¸ì˜¤ê¸°
                const keyword = document.getElementById('keyword').value.trim();
                
                // AI í”„ë¡¬í”„íŠ¸ ê°€ì ¸ì˜¤ê¸° (ë¹„ì–´ìˆì–´ë„ ë¨)
                const aiPromptTextarea = document.getElementById('aiPrompt');
                const aiPrompt = aiPromptTextarea ? aiPromptTextarea.value.trim() : '';
                
                // ìŠ¤í¬ë©ëœ ê¸€ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
                let scrapedContent = resultContent.textContent;
                
                // í…ìŠ¤íŠ¸ ëŒ€ì²´ ê¸°ëŠ¥
                const replaceText = document.getElementById('replaceText').value.trim();
                const newText = document.getElementById('newText').value.trim();
                
                if (replaceText && newText) {
                    const originalLength = scrapedContent.length;
                    scrapedContent = scrapedContent.replace(new RegExp(replaceText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi'), newText);
                    console.log(`[DEBUG] í…ìŠ¤íŠ¸ ëŒ€ì²´: "${replaceText}" â†’ "${newText}"`);
                    console.log(`[DEBUG] ëŒ€ì²´ í›„ ê¸€ ê¸¸ì´ ë³€í™”: ${originalLength}ì â†’ ${scrapedContent.length}ì`);
                }
                
                console.log(`[DEBUG] ìµœì¢… ìŠ¤í¬ë©ëœ ê¸€ ê¸¸ì´: ${scrapedContent.length}ì`);
                console.log(`[DEBUG] AI í”„ë¡¬í”„íŠ¸: ${aiPrompt || '(ë¹„ì–´ìˆìŒ - 30% ë³€ê²½ ëª¨ë“œ)'}`);
                
                // ì„œë²„ì— ìŠ¤í¬ë© ê¸°ë°˜ AI ê¸€ ìƒì„± ìš”ì²­
                const response = await fetch('/api/generate-ai-from-scraped', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        scrapedContent: scrapedContent,
                        aiPrompt: aiPrompt,
                        keyword: keyword
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // AI ìƒì„± ê¸€ í‘œì‹œ
                    aiResultContent.textContent = data.content;
                    
                    // ê²°ê³¼ ë©”ì‹œì§€ ì¶”ê°€
                    if (data.message) {
                        aiResultContent.textContent += `\n\nâ€» ${data.message}`;
                    }
                    
                    // ë¹„êµ ë²„íŠ¼ í‘œì‹œ
                    const compareBtn = document.getElementById('compareBtn');
                    compareBtn.style.display = 'block';
                    
                    // AI ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                    aiResult.scrollIntoView({ behavior: 'smooth' });
                    
                    console.log(`[INFO] AI ìƒì„± ì™„ë£Œ: ${data.generatedLength}ì (ì›ë³¸: ${data.originalLength}ì)`);
                } else {
                    throw new Error(data.error || 'AI ê¸€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
                
            } catch (error) {
                console.error('AI ê¸€ ìƒì„± ì˜¤ë¥˜:', error);
                aiResultContent.textContent = `AI ê¸€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}`;
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                aiGenerateBtn.disabled = false;
                aiGenerateBtn.innerHTML = 'ğŸ¤– Claudeë¡œ ê¸€ìƒì„±í•˜ê¸°';
            }
        }

        // Geminië¡œ ê¸€ìƒì„±í•˜ê¸° í•¨ìˆ˜
        async function generateGeminiContent() {
            const geminiGenerateBtn = document.getElementById('geminiGenerateBtn');
            const aiResult = document.getElementById('aiResult');
            const aiResultContent = document.getElementById('aiResultContent');
            const resultContent = document.getElementById('resultContent');
            
            if (!resultContent.textContent) {
                alert('ë¨¼ì € ìŠ¤í¬ë©ëœ ê¸€ì´ ìˆì–´ì•¼ Geminië¡œ ê¸€ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© ìƒíƒœ
            geminiGenerateBtn.disabled = true;
            geminiGenerateBtn.innerHTML = 'ğŸ”„ Geminiê°€ ê¸€ì„ ìƒì„±í•˜ëŠ” ì¤‘...';
            
            // AI ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            aiResult.style.display = 'block';
            
            // ì²«ë²ˆì§¸ ìƒì„±ëœê¸€ ê¸°ë°˜ ì¶”ê°€ ìƒì„± ë²„íŠ¼ë“¤ í‘œì‹œ
            const secondGenerationButtons = document.getElementById('secondGenerationButtons');
            secondGenerationButtons.style.display = 'block';
            aiResultContent.textContent = 'Geminiê°€ ìŠ¤í¬ë©ëœ ê¸€ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ë¸”ë¡œê·¸ ê¸€ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...';
            
            try {
                // í˜„ì¬ í‚¤ì›Œë“œ ê°€ì ¸ì˜¤ê¸°
                const keyword = document.getElementById('keyword').value.trim();
                
                // AI í”„ë¡¬í”„íŠ¸ ê°€ì ¸ì˜¤ê¸° (ë¹„ì–´ìˆì–´ë„ ë¨)
                const aiPromptTextarea = document.getElementById('aiPrompt');
                const aiPrompt = aiPromptTextarea ? aiPromptTextarea.value.trim() : '';
                
                // ìŠ¤í¬ë©ëœ ê¸€ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
                let scrapedContent = resultContent.textContent;
                
                // í…ìŠ¤íŠ¸ ëŒ€ì²´ ê¸°ëŠ¥
                const replaceText = document.getElementById('replaceText').value.trim();
                const newText = document.getElementById('newText').value.trim();
                
                if (replaceText && newText) {
                    const originalLength = scrapedContent.length;
                    scrapedContent = scrapedContent.replace(new RegExp(replaceText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi'), newText);
                    console.log(`[DEBUG] Gemini í…ìŠ¤íŠ¸ ëŒ€ì²´: "${replaceText}" â†’ "${newText}"`);
                    console.log(`[DEBUG] Gemini ëŒ€ì²´ í›„ ê¸€ ê¸¸ì´ ë³€í™”: ${originalLength}ì â†’ ${scrapedContent.length}ì`);
                }
                
                console.log(`[DEBUG] Gemini ìµœì¢… ìŠ¤í¬ë©ëœ ê¸€ ê¸¸ì´: ${scrapedContent.length}ì`);
                console.log(`[DEBUG] Gemini AI í”„ë¡¬í”„íŠ¸: ${aiPrompt || '(ë¹„ì–´ìˆìŒ - 30% ë³€ê²½ ëª¨ë“œ)'}`);
                
                // ì„œë²„ì— Gemini ê¸°ë°˜ AI ê¸€ ìƒì„± ìš”ì²­
                const response = await fetch('/api/generate-gemini-from-scraped', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        scrapedContent: scrapedContent,
                        aiPrompt: aiPrompt,
                        keyword: keyword
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Gemini ìƒì„± ê¸€ í‘œì‹œ
                    aiResultContent.textContent = data.content;
                    
                    // ê²°ê³¼ ë©”ì‹œì§€ ì¶”ê°€
                    if (data.message) {
                        aiResultContent.textContent += `\n\nâ€» ${data.message}`;
                    }
                    
                    // ë¹„êµ ë²„íŠ¼ í‘œì‹œ
                    const compareBtn = document.getElementById('compareBtn');
                    compareBtn.style.display = 'block';
                    
                    console.log(`[INFO] Gemini AI ê¸€ ìƒì„± ì™„ë£Œ: ${data.content.length}ì`);
                    
                    // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                    aiResult.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error(data.error || 'Gemini ê¸€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
                
            } catch (error) {
                console.error('Gemini ê¸€ ìƒì„± ì˜¤ë¥˜:', error);
                aiResultContent.textContent = `Gemini ê¸€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}`;
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                geminiGenerateBtn.disabled = false;
                geminiGenerateBtn.innerHTML = 'ğŸ’ Geminië¡œ ê¸€ìƒì„±í•˜ê¸°';
            }
        }
        
        // ì›ë¬¸ê³¼ ë¹„êµí•˜ê¸° í•¨ìˆ˜
        function compareTexts() {
            const resultContent = document.getElementById('resultContent');
            const aiResultContent = document.getElementById('aiResultContent');
            const comparisonResult = document.getElementById('comparisonResult');
            const comparisonContent = document.getElementById('comparisonContent');
            
            if (!resultContent.textContent || !aiResultContent.textContent) {
                alert('ìŠ¤í¬ë©ëœ ê¸€ê³¼ AI ìƒì„± ê¸€ì´ ëª¨ë‘ ìˆì–´ì•¼ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('[DEBUG] ì „ì²´ ë¬¸ë§¥ ê¸°ë°˜ ë¹„êµ ì‹œì‘');
            
            // ì›ë¬¸ê³¼ AI ìƒì„±ê¸€ ì „ì²´ í…ìŠ¤íŠ¸
            const originalText = resultContent.textContent.trim();
            const aiText = aiResultContent.textContent
                .replace(/\n\nâ€».*$/, '') // ë©”ì‹œì§€ ë¶€ë¶„ ì œê±°
                .trim();
            
            // AI í…ìŠ¤íŠ¸ì—ì„œ ì›ë¬¸ê³¼ ìœ ì‚¬í•œ ë¶€ë¶„ì„ ì°¾ì•„ì„œ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œ
            const highlightedAiText = highlightSimilarParts(originalText, aiText);
            
            // ì „ì²´ ìœ ì‚¬ë„ ê³„ì‚°
            const similarity = calculateAdvancedSimilarity(originalText, aiText);
            
            // ë¹„êµ ê²°ê³¼ HTML ìƒì„±
            let comparisonHTML = `
                <div style="margin-bottom: 20px; text-align: center;">
                    <p><strong>ì›ë¬¸:</strong> ${originalText.length}ì</p>
                    <p><strong>AI ìƒì„±ê¸€:</strong> ${aiText.length}ì</p>
                    <p><strong>ì „ì²´ ë¬¸ë§¥ ìœ ì‚¬ë„:</strong> ${similarity.toFixed(1)}%</p>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #333; margin-bottom: 10px;">ğŸ“„ ì›ë¬¸</h4>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; line-height: 1.8; border-left: 4px solid #6c757d;">
                        ${formatTextWithLineBreaks(originalText)}
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #dc3545; margin-bottom: 10px;">ğŸ¤– AI ìƒì„±ê¸€ (ìœ ì‚¬ ë¶€ë¶„ì€ <span style="color: red;">ë¹¨ê°„ìƒ‰</span>ìœ¼ë¡œ í‘œì‹œ)</h4>
                    <div style="background: #fff5f5; padding: 20px; border-radius: 8px; line-height: 1.8; border-left: 4px solid #dc3545;">
                        ${highlightedAiText}
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #e8f4fd; border-radius: 8px; text-align: center;">
                    <h4 style="margin: 0 0 10px 0; color: #1976d2;">ğŸ“Š ë¶„ì„ ê²°ê³¼</h4>
                    <p style="margin: 5px 0;"><strong>ë¬¸ë§¥ì  ìœ ì‚¬ë„:</strong> ${similarity.toFixed(1)}%</p>
                    <p style="margin: 5px 0;"><strong>ë…ì°½ì„±:</strong> ${(100 - similarity).toFixed(1)}%</p>
                    <p style="margin: 5px 0; font-size: 14px; color: #666;">
                        ${similarity > 80 ? 'ë§¤ìš° ìœ ì‚¬í•œ ë‚´ìš©' : 
                          similarity > 60 ? 'ìƒë‹¹íˆ ìœ ì‚¬í•œ ë‚´ìš©' : 
                          similarity > 40 ? 'ë¶€ë¶„ì ìœ¼ë¡œ ìœ ì‚¬í•œ ë‚´ìš©' : 'ëŒ€ë¶€ë¶„ ë‹¤ë¥¸ ë‚´ìš©'}
                    </p>
                </div>
            `;
            
            comparisonContent.innerHTML = comparisonHTML;
            comparisonResult.style.display = 'block';
            
            // ë¹„êµ ê²°ê³¼ë¡œ ìŠ¤í¬ë¡¤
            comparisonResult.scrollIntoView({ behavior: 'smooth' });
            
            console.log(`[INFO] ë¬¸ë§¥ ê¸°ë°˜ ë¹„êµ ì™„ë£Œ: ìœ ì‚¬ë„ ${similarity.toFixed(1)}%`);
        }
        
        // ê³ ê¸‰ ë¬¸ë§¥ ê¸°ë°˜ ìœ ì‚¬ë„ ê³„ì‚° í•¨ìˆ˜
        function calculateAdvancedSimilarity(text1, text2) {
            // í…ìŠ¤íŠ¸ë¥¼ ë‹¨ì–´/êµ¬ë¬¸ ë‹¨ìœ„ë¡œ ë¶„ì„
            const words1 = extractWords(text1);
            const words2 = extractWords(text2);
            const phrases1 = extractPhrases(text1);
            const phrases2 = extractPhrases(text2);
            
            // ë‹¨ì–´ ë ˆë²¨ ìœ ì‚¬ë„
            const wordSimilarity = calculateWordSimilarity(words1, words2);
            
            // êµ¬ë¬¸ ë ˆë²¨ ìœ ì‚¬ë„  
            const phraseSimilarity = calculatePhraseSimilarity(phrases1, phrases2);
            
            // ì „ì²´ êµ¬ì¡° ìœ ì‚¬ë„
            const structureSimilarity = calculateStructureSimilarity(text1, text2);
            
            // ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ìµœì¢… ìœ ì‚¬ë„ ê³„ì‚°
            const finalSimilarity = (wordSimilarity * 0.4 + phraseSimilarity * 0.4 + structureSimilarity * 0.2);
            
            return Math.max(0, Math.min(100, finalSimilarity));
        }

        // ìœ ì‚¬í•œ ë¶€ë¶„ì„ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function highlightSimilarParts(originalText, aiText) {
            // AI í…ìŠ¤íŠ¸ë¥¼ ë¬¸ì¥ ë‹¨ìœ„ë¡œ ë¶„ë¦¬
            const aiSentences = aiText.split(/([.!?]|\.\s)/g).filter(s => s.trim().length > 0);
            let highlightedText = '';
            
            for (let i = 0; i < aiSentences.length; i++) {
                const sentence = aiSentences[i];
                if (sentence.match(/^[.!?]$/) || sentence.match(/^\.\s$/)) {
                    highlightedText += sentence;
                    continue;
                }
                
                // ê° ë¬¸ì¥ì´ ì›ë¬¸ê³¼ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ í™•ì¸
                const similarity = findBestMatchSimilarity(sentence, originalText);
                
                if (similarity > 30) { // 30% ì´ìƒ ìœ ì‚¬í•˜ë©´ ë¹¨ê°„ìƒ‰ í‘œì‹œ
                    highlightedText += `<span style="color: red; font-weight: 500;">${sentence}</span>`;
                } else {
                    highlightedText += sentence;
                }
            }
            
            return formatTextWithLineBreaks(highlightedText);
        }

        // ë¬¸ì¥ê³¼ ì›ë¬¸ ì „ì²´ì—ì„œ ê°€ì¥ ìœ ì‚¬í•œ ë¶€ë¶„ ì°¾ê¸°
        function findBestMatchSimilarity(sentence, originalText) {
            const cleanSentence = sentence.replace(/[^\wê°€-í£\s]/g, '').trim();
            if (cleanSentence.length < 5) return 0;
            
            // ì›ë¬¸ì„ ë¬¸ì¥ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ì—¬ ê°ê°ê³¼ ë¹„êµ
            const originalSentences = originalText.split(/[.!?]/).filter(s => s.trim().length > 5);
            let maxSimilarity = 0;
            
            for (const origSentence of originalSentences) {
                const similarity = calculateSentenceSimilarity(cleanSentence, origSentence.trim());
                maxSimilarity = Math.max(maxSimilarity, similarity);
            }
            
            // ì—°ì†ëœ ë‹¨ì–´ ë§¤ì¹­ë„ í™•ì¸
            const words = cleanSentence.split(/\s+/);
            for (const word of words) {
                if (word.length > 2 && originalText.includes(word)) {
                    maxSimilarity = Math.max(maxSimilarity, 40);
                }
            }
            
            return maxSimilarity;
        }

        // ë‘ ë¬¸ì¥ ê°„ì˜ ìœ ì‚¬ë„ ê³„ì‚°
        function calculateSentenceSimilarity(sentence1, sentence2) {
            const words1 = sentence1.split(/\s+/).filter(w => w.length > 1);
            const words2 = sentence2.split(/\s+/).filter(w => w.length > 1);
            
            if (words1.length === 0 || words2.length === 0) return 0;
            
            let matchCount = 0;
            for (const word1 of words1) {
                for (const word2 of words2) {
                    if (word1 === word2 || (word1.length > 2 && word2.includes(word1)) || (word2.length > 2 && word1.includes(word2))) {
                        matchCount++;
                        break;
                    }
                }
            }
            
            return (matchCount / Math.max(words1.length, words2.length)) * 100;
        }

        // í…ìŠ¤íŠ¸ì—ì„œ ë‹¨ì–´ ì¶”ì¶œ
        function extractWords(text) {
            return text.replace(/[^\wê°€-í£\s]/g, ' ')
                      .split(/\s+/)
                      .filter(word => word.length > 1)
                      .map(word => word.toLowerCase());
        }

        // í…ìŠ¤íŠ¸ì—ì„œ êµ¬ë¬¸ ì¶”ì¶œ (2-3 ë‹¨ì–´ ì¡°í•©)
        function extractPhrases(text) {
            const words = extractWords(text);
            const phrases = [];
            
            for (let i = 0; i < words.length - 1; i++) {
                phrases.push(words[i] + ' ' + words[i + 1]);
                if (i < words.length - 2) {
                    phrases.push(words[i] + ' ' + words[i + 1] + ' ' + words[i + 2]);
                }
            }
            
            return phrases;
        }

        // ë‹¨ì–´ ë ˆë²¨ ìœ ì‚¬ë„ ê³„ì‚°
        function calculateWordSimilarity(words1, words2) {
            const set1 = new Set(words1);
            const set2 = new Set(words2);
            const intersection = new Set([...set1].filter(x => set2.has(x)));
            const union = new Set([...set1, ...set2]);
            
            return union.size > 0 ? (intersection.size / union.size) * 100 : 0;
        }

        // êµ¬ë¬¸ ë ˆë²¨ ìœ ì‚¬ë„ ê³„ì‚°
        function calculatePhraseSimilarity(phrases1, phrases2) {
            const set1 = new Set(phrases1);
            const set2 = new Set(phrases2);
            const intersection = new Set([...set1].filter(x => set2.has(x)));
            const union = new Set([...set1, ...set2]);
            
            return union.size > 0 ? (intersection.size / union.size) * 100 : 0;
        }

        // êµ¬ì¡°ì  ìœ ì‚¬ë„ ê³„ì‚°
        function calculateStructureSimilarity(text1, text2) {
            const sentences1 = text1.split(/[.!?]/).filter(s => s.trim().length > 0);
            const sentences2 = text2.split(/[.!?]/).filter(s => s.trim().length > 0);
            
            const lengthDiff = Math.abs(sentences1.length - sentences2.length);
            const maxLength = Math.max(sentences1.length, sentences2.length);
            
            return maxLength > 0 ? Math.max(0, (1 - lengthDiff / maxLength) * 100) : 0;
        }
        
        // AI ìƒì„± ê¸€ ë³µì‚¬ í•¨ìˆ˜
        async function copyAIToClipboard() {
            const aiCopyBtn = document.getElementById('aiCopyBtn');
            const aiResultContent = document.getElementById('aiResultContent');
            
            if (!aiResultContent.textContent) {
                alert('ë³µì‚¬í•  AI ìƒì„± ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            try {
                // ìµœì‹  ë¸Œë¼ìš°ì €ì˜ Clipboard API ì‚¬ìš©
                await navigator.clipboard.writeText(aiResultContent.textContent);
                
                // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
                aiCopyBtn.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
                aiCopyBtn.classList.add('copied');
                
                // 2ì´ˆ í›„ ì›ë˜ ìƒíƒœë¡œ ë³µì›
                setTimeout(() => {
                    aiCopyBtn.textContent = 'ğŸ“‹ ë³µì‚¬í•˜ê¸°';
                    aiCopyBtn.classList.remove('copied');
                }, 2000);
                
            } catch (err) {
                // Clipboard APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€ì²´ ë°©ë²• ì‚¬ìš©
                try {
                    const textArea = document.createElement('textarea');
                    textArea.value = aiResultContent.textContent;
                    textArea.style.position = 'fixed';
                    textArea.style.top = '-9999px';
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    
                    aiCopyBtn.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
                    aiCopyBtn.classList.add('copied');
                    
                    setTimeout(() => {
                        aiCopyBtn.textContent = 'ğŸ“‹ ë³µì‚¬í•˜ê¸°';
                        aiCopyBtn.classList.remove('copied');
                    }, 2000);
                    
                } catch (fallbackErr) {
                    console.error('ë³µì‚¬ ì‹¤íŒ¨:', fallbackErr);
                    alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ì—¬ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // ë‘ë²ˆì§¸ AI ìƒì„± ê¸€ ë³µì‚¬ í•¨ìˆ˜
        async function copyAI2ToClipboard() {
            const aiCopyBtn2 = document.getElementById('aiCopyBtn2');
            const aiResultContent2 = document.getElementById('aiResultContent2');
            
            if (!aiResultContent2.textContent) {
                alert('ë³µì‚¬í•  AI ìƒì„± ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            try {
                // ìµœì‹  ë¸Œë¼ìš°ì €ì˜ Clipboard API ì‚¬ìš©
                await navigator.clipboard.writeText(aiResultContent2.textContent);
                
                // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
                aiCopyBtn2.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
                aiCopyBtn2.classList.add('copied');
                
                // 2ì´ˆ í›„ ì›ë˜ ìƒíƒœë¡œ ë³µì›
                setTimeout(() => {
                    aiCopyBtn2.textContent = 'ğŸ“‹ ë³µì‚¬í•˜ê¸°';
                    aiCopyBtn2.classList.remove('copied');
                }, 2000);
                
            } catch (err) {
                // Clipboard APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€ì²´ ë°©ë²• ì‚¬ìš©
                try {
                    const textArea = document.createElement('textarea');
                    textArea.value = aiResultContent2.textContent;
                    textArea.style.position = 'fixed';
                    textArea.style.top = '-9999px';
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    
                    aiCopyBtn2.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
                    aiCopyBtn2.classList.add('copied');
                    
                    setTimeout(() => {
                        aiCopyBtn2.textContent = 'ğŸ“‹ ë³µì‚¬í•˜ê¸°';
                        aiCopyBtn2.classList.remove('copied');
                    }, 2000);
                    
                } catch (fallbackErr) {
                    console.error('ë³µì‚¬ ì‹¤íŒ¨:', fallbackErr);
                    alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ì—¬ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // ë‘ë²ˆì§¸ AI ìƒì„± ê¸€ê³¼ ì›ë¬¸ ë¹„êµ í•¨ìˆ˜
        function compareTexts2() {
            const resultContent = document.getElementById('resultContent');
            const aiResultContent2 = document.getElementById('aiResultContent2');
            const comparisonResult = document.getElementById('comparisonResult');
            const comparisonContent = document.getElementById('comparisonContent');
            
            if (!resultContent.textContent || !aiResultContent2.textContent) {
                alert('ìŠ¤í¬ë©ëœ ê¸€ê³¼ AI ìƒì„± ê¸€ì´ ëª¨ë‘ ìˆì–´ì•¼ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('[DEBUG] ë‘ë²ˆì§¸ ê¸€ ì „ì²´ ë¬¸ë§¥ ê¸°ë°˜ ë¹„êµ ì‹œì‘');
            
            // ì›ë¬¸ê³¼ AI ìƒì„±ê¸€ ì „ì²´ í…ìŠ¤íŠ¸
            const originalText = resultContent.textContent.trim();
            const aiText = aiResultContent2.textContent
                .replace(/\n\nâ€».*$/, '') // ë©”ì‹œì§€ ë¶€ë¶„ ì œê±°
                .trim();
            
            // AI í…ìŠ¤íŠ¸ì—ì„œ ì›ë¬¸ê³¼ ìœ ì‚¬í•œ ë¶€ë¶„ì„ ì°¾ì•„ì„œ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œ
            const highlightedAiText = highlightSimilarParts(originalText, aiText);
            
            // ì „ì²´ ìœ ì‚¬ë„ ê³„ì‚°
            const similarity = calculateAdvancedSimilarity(originalText, aiText);
            
            // ë¹„êµ ê²°ê³¼ HTML ìƒì„±
            let comparisonHTML = `
                <div style="margin-bottom: 20px; text-align: center;">
                    <p><strong>ì›ë¬¸:</strong> ${originalText.length}ì</p>
                    <p><strong>ë‘ë²ˆì§¸ AI ìƒì„±ê¸€:</strong> ${aiText.length}ì</p>
                    <p><strong>ì „ì²´ ë¬¸ë§¥ ìœ ì‚¬ë„:</strong> ${similarity.toFixed(1)}%</p>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #333; margin-bottom: 10px;">ğŸ“„ ì›ë¬¸</h4>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; line-height: 1.8; border-left: 4px solid #6c757d;">
                        ${formatTextWithLineBreaks(originalText)}
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #333; margin-bottom: 10px;">âœ¨ ë‘ë²ˆì§¸ AI ìƒì„±ê¸€ (ìœ ì‚¬í•œ ë¶€ë¶„ì€ <span style="color: red;">ë¹¨ê°„ìƒ‰</span>ìœ¼ë¡œ í‘œì‹œ)</h4>
                    <div style="background: #f0f8ff; padding: 20px; border-radius: 8px; line-height: 1.8; border-left: 4px solid #667eea;">
                        ${highlightedAiText}
                    </div>
                </div>
            `;
            
            comparisonContent.innerHTML = comparisonHTML;
            comparisonResult.style.display = 'block';
            
            // ìŠ¤í¬ë¡¤ë¡œ ë¹„êµ ê²°ê³¼ê¹Œì§€ ì´ë™
            comparisonResult.scrollIntoView({ behavior: 'smooth' });
            
            console.log(`[DEBUG] ë‘ë²ˆì§¸ ê¸€ ë¹„êµ ì™„ë£Œ - ìœ ì‚¬ë„: ${similarity.toFixed(1)}%`);
        }

        // ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ì„ ê¸°ë°˜ìœ¼ë¡œ Claudeë¡œ ìƒˆë¡œìš´ ê¸€ ìƒì„±
        async function generateFromFirstClaude() {
            const aiResultContent = document.getElementById('aiResultContent');
            const aiPrompt = document.getElementById('aiPrompt').value.trim();
            const aiResultContent2 = document.getElementById('aiResultContent2');
            const aiResult2 = document.getElementById('aiResult2');
            const generateFromFirstClaudeBtn = document.getElementById('generateFromFirstClaudeBtn');
            const compareBtn2 = document.getElementById('compareBtn2');
            
            if (!aiResultContent.textContent) {
                alert('ë¨¼ì € ì²«ë²ˆì§¸ AI ìƒì„± ê¸€ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (!aiPrompt) {
                alert('AI í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            generateFromFirstClaudeBtn.disabled = true;
            generateFromFirstClaudeBtn.innerHTML = 'ğŸ”„ Claudeê°€ ê¸€ì„ ìƒì„±í•˜ëŠ” ì¤‘...';
            
            // ë‘ë²ˆì§¸ AI ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            aiResult2.style.display = 'block';
            aiResultContent2.textContent = 'Claudeê°€ ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ë¸”ë¡œê·¸ ê¸€ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...';
            
            try {
                const keyword = document.getElementById('keyword').value.trim();
                const firstGeneratedContent = aiResultContent.textContent
                    .replace(/\n\nâ€».*$/, '') // ë©”ì‹œì§€ ë¶€ë¶„ ì œê±°
                    .trim();
                
                console.log('[DEBUG] ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ ê¸°ë°˜ Claude ìƒì„± ì‹œì‘');
                
                const response = await fetch('/api/generate-ai-from-scraped', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        scrapedContent: firstGeneratedContent,
                        aiPrompt: aiPrompt,
                        keyword: keyword,
                        useFirstContent: true  // ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ ê¸°ë°˜ì„ì„ í‘œì‹œ
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const formattedContent = formatTextWithLineBreaks(data.content);
                    aiResultContent2.innerHTML = formattedContent;
                    
                    if (data.message) {
                        aiResultContent2.innerHTML += `<br><br>â€» ${data.message}`;
                    }
                    
                    // ë¹„êµ ë²„íŠ¼ í‘œì‹œ
                    compareBtn2.style.display = 'block';
                    
                    console.log('[DEBUG] ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ ê¸°ë°˜ Claude ìƒì„± ì™„ë£Œ');
                } else {
                    aiResultContent2.textContent = `Claude ê¸€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${data.error}`;
                    console.error('[ERROR] Claude ìƒì„± ì‹¤íŒ¨:', data.error);
                }
                
            } catch (error) {
                console.error('[ERROR] Claude ìƒì„± ì¤‘ ì˜¤ë¥˜:', error);
                aiResultContent2.textContent = 'Claude ê¸€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                generateFromFirstClaudeBtn.disabled = false;
                generateFromFirstClaudeBtn.innerHTML = 'ğŸ¤– ì²«ë²ˆì§¸ ìƒì„±ëœê¸€ë¡œ Claude ê¸€ì‘ì„±í•˜ê¸°';
            }
        }

        // ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ì„ ê¸°ë°˜ìœ¼ë¡œ Geminië¡œ ìƒˆë¡œìš´ ê¸€ ìƒì„±
        async function generateFromFirstGemini() {
            const aiResultContent = document.getElementById('aiResultContent');
            const aiPrompt = document.getElementById('aiPrompt').value.trim();
            const aiResultContent2 = document.getElementById('aiResultContent2');
            const aiResult2 = document.getElementById('aiResult2');
            const generateFromFirstGeminiBtn = document.getElementById('generateFromFirstGeminiBtn');
            const compareBtn2 = document.getElementById('compareBtn2');
            
            if (!aiResultContent.textContent) {
                alert('ë¨¼ì € ì²«ë²ˆì§¸ AI ìƒì„± ê¸€ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (!aiPrompt) {
                alert('AI í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            generateFromFirstGeminiBtn.disabled = true;
            generateFromFirstGeminiBtn.innerHTML = 'ğŸ”„ Geminiê°€ ê¸€ì„ ìƒì„±í•˜ëŠ” ì¤‘...';
            
            // ë‘ë²ˆì§¸ AI ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            aiResult2.style.display = 'block';
            aiResultContent2.textContent = 'Geminiê°€ ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ë¸”ë¡œê·¸ ê¸€ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...';
            
            try {
                const keyword = document.getElementById('keyword').value.trim();
                const firstGeneratedContent = aiResultContent.textContent
                    .replace(/\n\nâ€».*$/, '') // ë©”ì‹œì§€ ë¶€ë¶„ ì œê±°
                    .trim();
                
                console.log('[DEBUG] ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ ê¸°ë°˜ Gemini ìƒì„± ì‹œì‘');
                
                const response = await fetch('/api/generate-gemini-from-scraped', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        scrapedContent: firstGeneratedContent,
                        aiPrompt: aiPrompt,
                        keyword: keyword,
                        useFirstContent: true  // ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ ê¸°ë°˜ì„ì„ í‘œì‹œ
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const formattedContent = formatTextWithLineBreaks(data.content);
                    aiResultContent2.innerHTML = formattedContent;
                    
                    if (data.message) {
                        aiResultContent2.innerHTML += `<br><br>â€» ${data.message}`;
                    }
                    
                    // ë¹„êµ ë²„íŠ¼ í‘œì‹œ
                    compareBtn2.style.display = 'block';
                    
                    console.log('[DEBUG] ì²«ë²ˆì§¸ ìƒì„±ëœ ê¸€ ê¸°ë°˜ Gemini ìƒì„± ì™„ë£Œ');
                } else {
                    aiResultContent2.textContent = `Gemini ê¸€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${data.error}`;
                    console.error('[ERROR] Gemini ìƒì„± ì‹¤íŒ¨:', data.error);
                }
                
            } catch (error) {
                console.error('[ERROR] Gemini ìƒì„± ì¤‘ ì˜¤ë¥˜:', error);
                aiResultContent2.textContent = 'Gemini ê¸€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                generateFromFirstGeminiBtn.disabled = false;
                generateFromFirstGeminiBtn.innerHTML = 'ğŸ’ ì²«ë²ˆì§¸ ìƒì„±ëœê¸€ë¡œ Gemini ê¸€ì‘ì„±í•˜ê¸°';
            }
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.getElementById('loginModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLoginModal();
            }
        });

        document.getElementById('settingsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSettingsModal();
            }
        });

        document.getElementById('keywordChoiceModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeKeywordChoiceModal();
            }
        });


        // í‚¤ì›Œë“œë°œêµ´ í™”ë©´ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showKeywordDiscovery() {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì„ í•œ í›„ì— ì‚¬ìš©í•˜ì‹­ì‹œì˜¤');
                return;
            }
            
            const mainContainer = document.querySelector('.container');
            const keywordDiscoveryPage = document.getElementById('keywordDiscoveryPage');
            
            mainContainer.style.display = 'none';
            keywordDiscoveryPage.style.display = 'block';
            
            // ìŠ¤í¬ë¡¤ì„ ë§¨ ìœ„ë¡œ
            window.scrollTo(0, 0);
        }

        async function discoverNewKeywords() {
            if (!currentUser) {
                alert('ë¡œê·¸ì¸ì„ í•œ í›„ì— ì‚¬ìš©í•˜ì‹­ì‹œì˜¤');
                return;
            }

            const newKeywordBtn = document.querySelector('.new-keyword-btn');
            const discoveryResults = document.getElementById('discoveryResults');
            
            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© ìƒíƒœ
            newKeywordBtn.disabled = true;
            newKeywordBtn.innerHTML = 'ğŸ”„ ì‹ ê·œí‚¤ì›Œë“œ ë°œêµ´ ì¤‘...';
            
            try {
                // ì‹ ê·œ í‚¤ì›Œë“œ ë°œêµ´ API í˜¸ì¶œ
                const [trendingResponse, emergingResponse, seasonalResponse] = await Promise.all([
                    fetch('/api/new-keywords/trending', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    }),
                    fetch('/api/new-keywords/emerging', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    }),
                    fetch('/api/new-keywords/seasonal', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    })
                ]);

                const [trendingData, emergingData, seasonalData] = await Promise.all([
                    trendingResponse.json(),
                    emergingResponse.json(),
                    seasonalResponse.json()
                ]);

                // ì‹ ê·œí‚¤ì›Œë“œ ê²°ê³¼ í‘œì‹œ
                displayNewKeywordResults(trendingData, emergingData, seasonalData);
                discoveryResults.style.display = 'block';
                discoveryResults.scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error('ì‹ ê·œí‚¤ì›Œë“œ ë°œêµ´ ì˜¤ë¥˜:', error);
                alert('ì‹ ê·œí‚¤ì›Œë“œ ë°œêµ´ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                newKeywordBtn.disabled = false;
                newKeywordBtn.innerHTML = 'ğŸ†• ì‹ ê·œí‚¤ì›Œë“œ ê²€ìƒ‰';
            }
        }

        function displayNewKeywordResults(trendingData, emergingData, seasonalData) {
            // ê¸°ë³¸ ë¶„ì„ì— ì‹ ê·œí‚¤ì›Œë“œ ê°œìš” í‘œì‹œ
            const basicAnalysis = document.getElementById('basicAnalysis');
            basicAnalysis.innerHTML = `
                <div style="padding: 20px; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; border-radius: 12px; text-align: center;">
                    <h3 style="margin: 0 0 15px 0; font-size: 1.4em;">ğŸ†• ì‹ ê·œí‚¤ì›Œë“œ ë°œêµ´ ê²°ê³¼</h3>
                    <p style="margin: 0; font-size: 1.1em; opacity: 0.9;">ìµœì‹  íŠ¸ë Œë“œì™€ ê¸‰ìƒìŠ¹ í‚¤ì›Œë“œë¥¼ ë°œêµ´í–ˆìŠµë‹ˆë‹¤</p>
                    <p style="margin: 10px 0 0 0; font-size: 0.9em; opacity: 0.8;">ì´ ${(trendingData.keywords?.length || 0) + (emergingData.keywords?.length || 0) + (seasonalData.keywords?.length || 0)}ê°œì˜ ì‹ ê·œ í‚¤ì›Œë“œë¥¼ ë°œê²¬í–ˆìŠµë‹ˆë‹¤</p>
                </div>
            `;

            // ì—°ê´€ í‚¤ì›Œë“œ â†’ íŠ¸ë Œë”© í‚¤ì›Œë“œ
            const relatedKeywords = document.getElementById('relatedKeywords');
            if (trendingData.success && trendingData.keywords) {
                relatedKeywords.innerHTML = trendingData.keywords.slice(0, 15).map(kw => `
                    <div style="display: inline-block; margin: 5px; padding: 10px 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 25px; font-size: 14px; font-weight: 600; cursor: pointer;" onclick="selectNewKeyword('${kw.keyword}')">
                        ğŸ”¥ ${kw.keyword} <small>(+${kw.growth || 'ì‹ ê·œ'})</small>
                    </div>
                `).join('');
                // ì œëª© ë³€ê²½
                document.querySelector('#relatedKeywords').parentElement.querySelector('h4').innerHTML = 'ğŸ”¥ íŠ¸ë Œë”© í‚¤ì›Œë“œ';
            }

            // ë¡±í…Œì¼ í‚¤ì›Œë“œ â†’ ê¸‰ìƒìŠ¹ í‚¤ì›Œë“œ
            const longTailKeywords = document.getElementById('longTailKeywords');
            if (emergingData.success && emergingData.keywords) {
                longTailKeywords.innerHTML = emergingData.keywords.slice(0, 12).map(kw => `
                    <div style="display: inline-block; margin: 5px; padding: 10px 15px; background: linear-gradient(135deg, #ff9a56 0%, #ff6b35 100%); color: white; border-radius: 25px; font-size: 14px; font-weight: 600; cursor: pointer;" onclick="selectNewKeyword('${kw.keyword}')">
                        ğŸ“ˆ ${kw.keyword} <small>(${kw.searchVolume || 'N/A'})</small>
                    </div>
                `).join('');
                // ì œëª© ë³€ê²½
                document.querySelector('#longTailKeywords').parentElement.querySelector('h4').innerHTML = 'ğŸ“ˆ ê¸‰ìƒìŠ¹ í‚¤ì›Œë“œ';
            }

            // ê¸‰ìƒìŠ¹ í‚¤ì›Œë“œ â†’ ê³„ì ˆì„± í‚¤ì›Œë“œ
            const trendingKeywords = document.getElementById('trendingKeywords');
            if (seasonalData.success && seasonalData.keywords) {
                trendingKeywords.innerHTML = seasonalData.keywords.slice(0, 10).map(kw => `
                    <div style="display: inline-block; margin: 5px; padding: 10px 15px; background: linear-gradient(135deg, #26d0ce 0%, #1a9bf0 100%); color: white; border-radius: 25px; font-size: 14px; font-weight: 600; cursor: pointer;" onclick="selectNewKeyword('${kw.keyword}')">
                        ğŸŒŸ ${kw.keyword} <small>(${kw.season || 'ì‹œì¦Œ'})</small>
                    </div>
                `).join('');
                // ì œëª© ë³€ê²½
                document.querySelector('#trendingKeywords').parentElement.querySelector('h4').innerHTML = 'ğŸŒŸ ê³„ì ˆì„± í‚¤ì›Œë“œ';
            }
        }

        function selectNewKeyword(keyword) {
            // ì„ íƒëœ í‚¤ì›Œë“œë¥¼ ì €ì¥í•˜ê³  ëª¨ë‹¬ì°½ í‘œì‹œ (ì‹ ê·œí‚¤ì›Œë“œë„ ë™ì¼í•œ ëª¨ë‹¬ ì‚¬ìš©)
            selectedKeywordForChoice = keyword;
            document.getElementById('selectedKeywordText').textContent = keyword;
            document.getElementById('keywordChoiceModal').style.display = 'block';
        }

        function hideKeywordDiscovery() {
            const mainContainer = document.querySelector('.container');
            const keywordDiscoveryPage = document.getElementById('keywordDiscoveryPage');
            
            keywordDiscoveryPage.style.display = 'none';
            mainContainer.style.display = 'block';
            
            // ìŠ¤í¬ë¡¤ì„ ë§¨ ìœ„ë¡œ
            window.scrollTo(0, 0);
        }

        async function startKeywordDiscovery() {
            const keywordInput = document.getElementById('keywordDiscoveryInput');
            const keyword = keywordInput.value.trim();
            
            if (!keyword) {
                alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const searchBtn = document.querySelector('.search-btn');
            const discoveryResults = document.getElementById('discoveryResults');
            
            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© ìƒíƒœ
            searchBtn.disabled = true;
            searchBtn.innerHTML = 'ğŸ”„ ë°œêµ´ ì¤‘...';
            
            try {
                // ê¸°ë³¸ ë¶„ì„, ì—°ê´€ í‚¤ì›Œë“œ, ë¡±í…Œì¼, íŠ¸ë Œë“œ ëª¨ë‘ í•œë²ˆì— ìš”ì²­
                const [competitionResponse, relatedResponse, trendsResponse] = await Promise.all([
                    fetch('/api/keyword-research/competition', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ keyword })
                    }),
                    fetch('/api/keyword-research/related', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ keyword })
                    }),
                    fetch('/api/keyword-research/trends', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ keyword })
                    })
                ]);

                const [competitionData, relatedData, trendsData] = await Promise.all([
                    competitionResponse.json(),
                    relatedResponse.json(),
                    trendsResponse.json()
                ]);

                // ê²°ê³¼ í‘œì‹œ
                displayDiscoveryResults(competitionData, relatedData, trendsData);
                discoveryResults.style.display = 'block';
                discoveryResults.scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error('í‚¤ì›Œë“œ ë°œêµ´ ì˜¤ë¥˜:', error);
                alert('í‚¤ì›Œë“œ ë°œêµ´ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                searchBtn.disabled = false;
                searchBtn.innerHTML = 'ğŸ” í‚¤ì›Œë“œ ë°œêµ´ ì‹œì‘';
            }
        }

        function displayDiscoveryResults(competitionData, relatedData, trendsData) {
            // ê¸°ë³¸ ë¶„ì„ í‘œì‹œ
            const basicAnalysis = document.getElementById('basicAnalysis');
            if (competitionData.success) {
                const analysis = competitionData.analysis;
                basicAnalysis.innerHTML = `
                    <div style="padding: 15px; background: white; border-radius: 8px; border-left: 4px solid #4CAF50;">
                        <p><strong>ê²€ìƒ‰ëŸ‰:</strong> ${analysis.searchVolume?.toLocaleString() || 'N/A'}</p>
                        <p><strong>ê²½ìŸë„:</strong> <span class="keyword-competition ${analysis.competition}">${getCompetitionText(analysis.competition)}</span></p>
                        <p><strong>KEI ì ìˆ˜:</strong> ${analysis.keiScore || 'N/A'}</p>
                        <p><strong>ë‚œì´ë„:</strong> ${analysis.difficulty || 'N/A'}</p>
                        <p><strong>ì¶”ì²œë„:</strong> ${analysis.recommendation || 'N/A'}</p>
                    </div>
                `;
            }

            // ì—°ê´€ í‚¤ì›Œë“œ í‘œì‹œ
            const relatedKeywords = document.getElementById('relatedKeywords');
            if (relatedData.success && relatedData.relatedKeywords) {
                relatedKeywords.innerHTML = relatedData.relatedKeywords.slice(0, 10).map(kw => `
                    <div style="display: inline-block; margin: 5px; padding: 8px 12px; background: #e3f2fd; border-radius: 20px; font-size: 14px; cursor: pointer;" onclick="selectKeyword('${kw.keyword}')">
                        ${kw.keyword} <small>(${kw.searchVolume})</small>
                    </div>
                `).join('');
            }

            // ë¡±í…Œì¼ í‚¤ì›Œë“œ í‘œì‹œ
            const longTailKeywords = document.getElementById('longTailKeywords');
            if (relatedData.success && relatedData.longTailKeywords) {
                longTailKeywords.innerHTML = relatedData.longTailKeywords.slice(0, 15).map(kw => `
                    <div style="display: inline-block; margin: 5px; padding: 8px 12px; background: #f3e5f5; border-radius: 20px; font-size: 14px; cursor: pointer;" onclick="selectKeyword('${kw.keyword}')">
                        ${kw.keyword} <small>(${kw.searchVolume})</small>
                    </div>
                `).join('');
            }

            // ê¸‰ìƒìŠ¹ í‚¤ì›Œë“œ í‘œì‹œ
            const trendingKeywords = document.getElementById('trendingKeywords');
            if (trendsData.success && trendsData.trends) {
                trendingKeywords.innerHTML = trendsData.trends.trendingKeywords?.slice(0, 10).map(kw => `
                    <div style="display: inline-block; margin: 5px; padding: 8px 12px; background: #fff3e0; border-radius: 20px; font-size: 14px; cursor: pointer;" onclick="selectKeyword('${kw.keyword}')">
                        ${kw.keyword} <small>(+${kw.growthRate}%)</small>
                    </div>
                `).join('') || '<p>ê¸‰ìƒìŠ¹ í‚¤ì›Œë“œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }
    </script>
</body>
</html>